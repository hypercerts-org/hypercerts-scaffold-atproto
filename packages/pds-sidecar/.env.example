# =============================================================================
# PDS Sidecar Stack — Environment Variables
# Copy this file to .env and fill in the values. Never commit .env to git.
# =============================================================================

# -----------------------------------------------------------------------------
# PDS Core Configuration
# -----------------------------------------------------------------------------

# The public hostname of the PDS (e.g. pds.certs.network)
PDS_HOSTNAME=pds.certs.network

# Directory where the PDS stores its SQLite database and other data
# (mapped to /data inside the container via the pds_data volume)
PDS_DATA_DIRECTORY=/data

# Directory where the PDS stores uploaded blobs
PDS_BLOBSTORE_DISK_LOCATION=/data/blobs

# URL of the PLC directory (use the production directory or run your own)
PDS_DID_PLC_URL=https://plc.directory

# Admin password for the PDS XRPC admin endpoints
PDS_ADMIN_PASSWORD=change-me-strong-random-password

# Secret used to sign JWTs issued by the PDS
PDS_JWT_SECRET=change-me-64-char-random-hex-string

# PLC rotation key — secp256k1 private key in hex (64 hex chars = 32 bytes)
# Generate with: openssl ecparam -name secp256k1 -genkey -noout | openssl ec -text -noout 2>/dev/null | grep priv -A 3 | tail -3 | tr -d ' \n:'
PDS_PLC_ROTATION_KEY_K256_PRIVATE_KEY_HEX=change-me-64-char-hex-secp256k1-private-key

# -----------------------------------------------------------------------------
# Auth Service Configuration
# -----------------------------------------------------------------------------

# TCP port the auth service listens on inside the container
AUTH_PORT=3001

# Path to the auth service SQLite database inside the container
AUTH_DB_PATH=/data/auth.sqlite

# Secret used to sign session cookies (use a long random string)
SESSION_SECRET=change-me-64-char-random-session-secret

# SMTP server hostname for sending OTP emails
SMTP_HOST=smtp.example.com

# SMTP server port (587 for STARTTLS, 465 for implicit TLS)
SMTP_PORT=587

# Set to "true" if using implicit TLS (port 465), "false" for STARTTLS (port 587)
SMTP_SECURE=false

# SMTP authentication credentials
SMTP_USER=your-smtp-username
SMTP_PASS=your-smtp-password

# From address shown in OTP emails
SMTP_FROM=Certified PDS <noreply@pds.certs.network>

# -----------------------------------------------------------------------------
# Shared Configuration
# -----------------------------------------------------------------------------

# HMAC secret shared between the auth service and PDS core for signing callbacks.
# Must be the same value in both services. Use a long random string.
# Generate with: openssl rand -hex 32
CALLBACK_SECRET=change-me-64-char-random-hmac-secret

# Internal URL the auth service uses to reach the PDS (Docker service name)
PDS_URL=http://pds:3000

# Public URL of the auth service (used by PDS to rewrite OAuth metadata)
AUTH_SERVICE_URL=https://auth.pds.certs.network

# Path to the sidecar SQLite database inside the PDS container
# (stores email→DID mappings created during account creation)
SIDECAR_DB_PATH=/data/sidecar.sqlite

# -----------------------------------------------------------------------------
# Caddy / TLS Configuration
# -----------------------------------------------------------------------------

# DNS provider plugin name for Caddy (used for wildcard cert DNS challenge).
# See https://caddyserver.com/docs/automatic-https#dns-challenge for providers.
# Example values: cloudflare, route53, digitalocean
CADDY_DNS_PROVIDER=cloudflare

# API key / token for the DNS provider (used by Caddy to create DNS-01 challenge records)
CADDY_DNS_API_KEY=your-dns-provider-api-key
