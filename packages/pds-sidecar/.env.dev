# =============================================================================
# PDS Sidecar Stack — Local Development Environment
# =============================================================================
# This file is pre-configured for local development on localhost.
# The only values you need to fill in are the crypto keys.
#
# SETUP:
#   1. Generate keys:  node scripts/generate-pds-keys.mjs
#   2. Paste the output below (replace the <generated> placeholders)
#   3. Run:            scripts/dev-start.sh
# =============================================================================

# -----------------------------------------------------------------------------
# PDS Core Configuration
# -----------------------------------------------------------------------------

# The public hostname of the PDS (localhost for local dev)
PDS_HOSTNAME=localhost

# Port the PDS listens on
PDS_PORT=2583

# Directory where the PDS stores its SQLite databases and other data
PDS_DATA_DIRECTORY=./data/pds

# Directory where the PDS stores uploaded blobs
PDS_BLOBSTORE_DISK_LOCATION=./data/pds/blobs

# URL of the PLC directory (use the production directory)
PDS_DID_PLC_URL=https://plc.directory

# Admin password for the PDS XRPC admin endpoints
# Generate with: node scripts/generate-pds-keys.mjs
PDS_ADMIN_PASSWORD=<generated>

# Secret used to sign JWTs issued by the PDS (64 hex chars)
# Generate with: node scripts/generate-pds-keys.mjs
PDS_JWT_SECRET=<generated>

# PLC rotation key — secp256k1 private key in hex (64 hex chars = 32 bytes)
# Generate with: node scripts/generate-pds-keys.mjs
PDS_PLC_ROTATION_KEY_K256_PRIVATE_KEY_HEX=<generated>

# Disable invite requirement for local dev
PDS_INVITE_REQUIRED=false

# Enable dev mode (disables SSRF protection so PDS can reach localhost services)
PDS_DEV_MODE=true

# -----------------------------------------------------------------------------
# Auth Service Configuration
# -----------------------------------------------------------------------------

# Port the auth service listens on
AUTH_PORT=2584

# Path to the auth service SQLite database
AUTH_DB_PATH=./data/auth/auth.sqlite

# Secret used to sign session cookies (64 hex chars)
# Generate with: node scripts/generate-pds-keys.mjs
SESSION_SECRET=<generated>

# URL the auth service uses to reach the PDS (internal, server-to-server)
PDS_URL=http://localhost:2583

# Public URL of the auth service (used by PDS to rewrite OAuth metadata)
# This is the URL the BROWSER will be redirected to — must be reachable from your machine
AUTH_SERVICE_URL=http://localhost:2584

# -----------------------------------------------------------------------------
# Shared Configuration
# -----------------------------------------------------------------------------

# HMAC secret shared between the auth service and PDS core for signing callbacks.
# Must be the same value in both services.
# Generate with: node scripts/generate-pds-keys.mjs
CALLBACK_SECRET=<generated>

# Path to the sidecar SQLite database (stores email→DID mappings)
SIDECAR_DB_PATH=./data/pds/sidecar.sqlite

# -----------------------------------------------------------------------------
# SMTP (MailHog — fake SMTP for local dev)
# -----------------------------------------------------------------------------

# MailHog SMTP server (started by dev-start.sh via Docker)
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false

# No auth needed for MailHog
SMTP_USER=
SMTP_PASS=

# From address shown in OTP emails
SMTP_FROM="Hypercerts Scaffold <noreply@localhost>"
