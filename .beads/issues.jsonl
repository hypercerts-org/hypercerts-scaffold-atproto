{"id":"hypercerts-02l","title":"Epic: Migrate OAuth scopes from transitional to granular (production only)","description":"Currently OAUTH_SCOPE is a single constant 'atproto transition:generic' used in all environments. For production, we should use granular scopes that precisely describe what the app needs: repo access to hypercert collections + profiles, blob uploads, and RPC calls. For loopback (local dev), transition:generic must remain (ATProto requirement for loopback clients). The granular scope constants already exist in lib/hypercerts-sdk.ts (HYPERCERT_REPO_SCOPE, RPC_SCOPE, BLOB_SCOPE) but are unused. However, HYPERCERT_REPO_SCOPE is incomplete — it's missing collections the app writes to (app.certified.actor.profile, app.bsky.actor.profile, org.hypercerts.claim.attachment, org.hypercerts.claim.contributionDetails, org.hypercerts.claim.contributorInformation, org.hypercerts.helper.workScopeTag). Success: production deployments request only the granular permissions needed; loopback still uses transition:generic; all existing functionality works.","status":"open","priority":2,"issue_type":"epic","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","created_at":"2026-02-17T19:10:32.060816026+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:26:13.671302236+06:00","labels":["needs-integration-review","scope:small"]}
{"id":"hypercerts-02l.1","title":"Update HYPERCERT_REPO_SCOPE to include all collections the app writes to","description":"## Files\n- lib/hypercerts-sdk.ts (modify)\n\n## What to do\nThe `HYPERCERT_REPO_SCOPE` constant (line 11-12) is missing several collections that the app and SDK internally write to. Update it to include ALL collections from `HYPERCERT_COLLECTIONS` that the app needs write access to.\n\nCurrent scope has these collections:\n- org.hypercerts.claim.activity ✓\n- org.hypercerts.claim.contribution ✓  \n- org.hypercerts.claim.evaluation ✓\n- org.hypercerts.claim.evidence ✓\n- org.hypercerts.claim.measurement ✓\n- org.hypercerts.claim.collection ✓\n- org.hypercerts.claim.rights ✓\n- org.hypercerts.claim.funding ✓\n- app.certified.location ✓\n\nAdd these missing collections:\n- org.hypercerts.claim.attachment (used by addAttachment in app/api/certs/add-attachment/route.ts)\n- org.hypercerts.claim.contributionDetails (SDK creates these internally during hypercert creation with contributions)\n- org.hypercerts.claim.contributorInformation (SDK creates these internally during hypercert creation with contributions)\n- org.hypercerts.helper.workScopeTag (SDK may create these for work scope references)\n- app.certified.actor.profile (used by profile create/update in app/api/profile/update/route.ts)\n- app.bsky.actor.profile (used by bsky profile create/update in app/api/profile/bsky/update/route.ts)\n\nUse `HYPERCERT_COLLECTIONS` from `@hypercerts-org/sdk-core` to build the scope string programmatically instead of hardcoding collection names. Import it and construct the scope like:\n\n```typescript\nimport { HYPERCERT_COLLECTIONS } from \"@hypercerts-org/sdk-core\";\n\nconst REPO_COLLECTIONS = [\n  HYPERCERT_COLLECTIONS.CLAIM,\n  HYPERCERT_COLLECTIONS.RIGHTS,\n  HYPERCERT_COLLECTIONS.LOCATION,\n  HYPERCERT_COLLECTIONS.CONTRIBUTION_DETAILS,\n  HYPERCERT_COLLECTIONS.CONTRIBUTOR_INFORMATION,\n  HYPERCERT_COLLECTIONS.MEASUREMENT,\n  HYPERCERT_COLLECTIONS.EVALUATION,\n  HYPERCERT_COLLECTIONS.ATTACHMENT,\n  HYPERCERT_COLLECTIONS.COLLECTION,\n  HYPERCERT_COLLECTIONS.FUNDING_RECEIPT,\n  HYPERCERT_COLLECTIONS.WORK_SCOPE_TAG,\n  HYPERCERT_COLLECTIONS.BSKY_PROFILE,\n  HYPERCERT_COLLECTIONS.CERTIFIED_PROFILE,\n];\n\nconst collectionParams = REPO_COLLECTIONS.map(c =\u003e `collection=${c}`).join(\"\u0026\");\nexport const HYPERCERT_REPO_SCOPE = `repo?${collectionParams}\u0026action=create\u0026action=update\u0026action=delete`;\n```\n\nAlso remove the comment \"// Future granular scopes (not yet used)\" on line 10 since they will now be used.\n\n## Don't\n- Change RPC_SCOPE or BLOB_SCOPE — they are already correct\n- Change how the SDK is initialized\n- Change any exports or the default export","acceptance_criteria":"1. HYPERCERT_REPO_SCOPE includes all collections from HYPERCERT_COLLECTIONS that the app writes to (at minimum: activity, rights, location, contributionDetails, contributorInformation, measurement, evaluation, attachment, collection, funding receipt, workScopeTag, bsky profile, certified profile).\n2. Collection names are sourced from the HYPERCERT_COLLECTIONS constant, not hardcoded strings.\n3. The scope string retains action=create\u0026action=update\u0026action=delete.\n4. The \"Future granular scopes\" comment is removed.\n5. npm run build succeeds with no type errors.","notes":"Merged into hypercerts-02l.2 — scope definition and env-switching are one atomic change","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":20,"created_at":"2026-02-17T19:10:53.189448756+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:11:33.879319675+06:00","closed_at":"2026-02-17T19:11:33.879324735+06:00","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-02l.1","depends_on_id":"hypercerts-02l","type":"parent-child","created_at":"2026-02-17T19:10:53.19186715+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-02l.2","title":"Make OAUTH_SCOPE environment-aware: granular for production, transitional for loopback","description":"## Files\n- lib/config.ts (modify)\n- lib/hypercerts-sdk.ts (modify)\n\n## What to do\nCurrently `OAUTH_SCOPE` in `lib/config.ts` (line 19) is a single constant:\n```typescript\nexport const OAUTH_SCOPE = [ATPROTO_SCOPE, TRANSITION_SCOPES.GENERIC].join(\" \");\n```\n\nThis is used everywhere regardless of environment. Change it so:\n- **Loopback (local dev):** keeps `\"atproto transition:generic\"` (ATProto requirement)\n- **Production:** uses the granular scopes: `ATPROTO_SCOPE + HYPERCERT_REPO_SCOPE + RPC_SCOPE + BLOB_SCOPE`\n\n### In lib/config.ts:\n\n1. Import `HYPERCERT_REPO_SCOPE`, `RPC_SCOPE`, `BLOB_SCOPE` from `./hypercerts-sdk` — BUT this creates a circular dependency since `hypercerts-sdk.ts` imports from `config.ts`. Instead, move the scope constants into `config.ts` or create a new file. The cleanest approach: move the granular scope construction into `config.ts` itself.\n\n   Import `HYPERCERT_COLLECTIONS` from `@hypercerts-org/sdk-core` (already importing from there) and build the scopes in `config.ts`:\n\n```typescript\nimport { ATPROTO_SCOPE, TRANSITION_SCOPES, HYPERCERT_COLLECTIONS } from \"@hypercerts-org/sdk-core\";\n\n// Granular repo scope — all collections the app needs write access to\nconst REPO_COLLECTIONS = [\n  HYPERCERT_COLLECTIONS.CLAIM,\n  HYPERCERT_COLLECTIONS.RIGHTS,\n  HYPERCERT_COLLECTIONS.LOCATION,\n  HYPERCERT_COLLECTIONS.CONTRIBUTION_DETAILS,\n  HYPERCERT_COLLECTIONS.CONTRIBUTOR_INFORMATION,\n  HYPERCERT_COLLECTIONS.MEASUREMENT,\n  HYPERCERT_COLLECTIONS.EVALUATION,\n  HYPERCERT_COLLECTIONS.ATTACHMENT,\n  HYPERCERT_COLLECTIONS.COLLECTION,\n  HYPERCERT_COLLECTIONS.FUNDING_RECEIPT,\n  HYPERCERT_COLLECTIONS.WORK_SCOPE_TAG,\n  HYPERCERT_COLLECTIONS.BSKY_PROFILE,\n  HYPERCERT_COLLECTIONS.CERTIFIED_PROFILE,\n];\n\nconst HYPERCERT_REPO_SCOPE = `repo?${REPO_COLLECTIONS.map(c =\u003e \"collection=\" + c).join(\"\u0026\")}\u0026action=create\u0026action=update\u0026action=delete`;\nconst RPC_SCOPE = \"rpc:app.bsky.actor.getProfile?aud=did:web:api.bsky.app%23bsky_appview\";\nconst BLOB_SCOPE = \"blob?accept=video/*\u0026accept=image/*\";\n\nconst GRANULAR_SCOPE = [ATPROTO_SCOPE, HYPERCERT_REPO_SCOPE, RPC_SCOPE, BLOB_SCOPE].join(\" \");\nconst LOOPBACK_SCOPE = [ATPROTO_SCOPE, TRANSITION_SCOPES.GENERIC].join(\" \");\n```\n\n2. Change `OAUTH_SCOPE` to be a function of the base URL (loopback detection already exists in this file):\n\n```typescript\nfunction getOAuthScope(baseUrl: string): string {\n  if (isLoopback(baseUrl)) {\n    return LOOPBACK_SCOPE;\n  }\n  return GRANULAR_SCOPE;\n}\n```\n\n3. Replace the current `OAUTH_SCOPE` constant (line 19) with the function call. Since `baseUrl` is computed at module level (line 154), place the scope computation after it:\n\n```typescript\nexport const OAUTH_SCOPE = getOAuthScope(baseUrl);\n```\n\n   Move this line to after `const baseUrl = getBaseUrl();` (around line 154), or keep the export at the top and make it lazy. The simplest: move the export to after line 154.\n\n4. Update the JSDoc comment above OAUTH_SCOPE to explain the dual behavior.\n\n### In lib/hypercerts-sdk.ts:\n\n5. Remove the now-redundant scope constants (`HYPERCERT_REPO_SCOPE`, `RPC_SCOPE`, `BLOB_SCOPE`) since they are now defined in `config.ts`. Keep the `export { OAUTH_SCOPE }` re-export.\n\n## Don't\n- Change the loopback detection logic\n- Change how `buildClientId` works (it already receives scope as a parameter)\n- Change the SDK initialization (it already uses `config.scope`)\n- Change `client-metadata.json/route.ts` — it already imports OAUTH_SCOPE from config\n- Break the circular dependency: config.ts must NOT import from hypercerts-sdk.ts","acceptance_criteria":"1. When running locally (loopback), OAUTH_SCOPE equals \"atproto transition:generic\".\n2. When running in production (non-loopback), OAUTH_SCOPE contains granular scopes: atproto, repo?collection=...\u0026action=..., rpc:..., blob?....\n3. The scope constants (HYPERCERT_REPO_SCOPE, RPC_SCOPE, BLOB_SCOPE) are removed from lib/hypercerts-sdk.ts.\n4. No circular dependency between config.ts and hypercerts-sdk.ts.\n5. All existing imports of OAUTH_SCOPE continue to work (from both lib/config and lib/hypercerts-sdk).\n6. npm run build succeeds with no type errors.","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T19:11:23.981953959+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:25:47.051699941+06:00","closed_at":"2026-02-17T19:25:47.051699941+06:00","close_reason":"a3b2ede Make OAUTH_SCOPE environment-aware: granular for production, loopback for dev","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-02l.2","depends_on_id":"hypercerts-02l","type":"parent-child","created_at":"2026-02-17T19:11:23.983818358+06:00","created_by":"karma.gainforest.id"},{"issue_id":"hypercerts-02l.2","depends_on_id":"hypercerts-02l.1","type":"blocks","created_at":"2026-02-17T19:11:23.986580861+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-02l.3","title":"Fix BLOB_SCOPE to allow all MIME types, not just image/* and video/*","description":"## Files\n- lib/config.ts (modify)\n\n## What to do\nLine 38 currently restricts blob uploads to only images and videos:\n```typescript\nconst BLOB_SCOPE = \"blob?accept=video/*\u0026accept=image/*\";\n```\n\nThe app uploads attachments of arbitrary types (markdown, PDF, GeoJSON, etc.) via the add-attachment flow. This causes the error: `Failed to upload blob: Missing required scope \"blob:text/markdown\"`.\n\nChange BLOB_SCOPE to use the wildcard MIME type `*/*` which matches any content type:\n```typescript\nconst BLOB_SCOPE = \"blob:*/*\";\n```\n\nNote the syntax difference: `blob:*/*` (colon, single MIME pattern) vs `blob?accept=...` (query params, multiple patterns). The `blob:*/*` form is the correct ATProto scope syntax for a single wildcard MIME type. The SDK's `hasPermission` function confirms `blob:*/*` matches any specific MIME type like `blob:text/markdown`.\n\n## Don't\n- Change any other scope constants\n- Add individual MIME types — use the wildcard instead","acceptance_criteria":"1. BLOB_SCOPE on line 38 of lib/config.ts is changed to \"blob:*/*\".\n2. npm run build succeeds with no type errors.","status":"closed","priority":1,"issue_type":"bug","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":5,"created_at":"2026-02-17T19:40:26.168827229+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:41:47.569135839+06:00","closed_at":"2026-02-17T19:41:47.569135839+06:00","close_reason":"b403f8b fix BLOB_SCOPE to use wildcard */* for all MIME types","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-02l.3","depends_on_id":"hypercerts-02l","type":"parent-child","created_at":"2026-02-17T19:40:26.170442006+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-0h4","title":"Epic: Improve error messages across the scaffold","description":"Users (including the developer) see generic errors like 'Failed to add measurement', 'Authentication failed. Please try again.', and 'Unable to get repository context' with zero context about what actually went wrong. This makes debugging impossible without checking server logs. Success looks like: every user-facing error toast includes a specific reason (e.g. 'Failed to add measurement: session expired, please log in again'), and every server-side throw includes the operation name and relevant IDs. Key constraint: don't expose internal implementation details or secrets in user-facing messages.","status":"open","priority":2,"issue_type":"epic","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","created_at":"2026-02-17T18:08:29.842621842+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:15:50.724143802+06:00","labels":["needs-integration-review","scope:medium"]}
{"id":"hypercerts-0h4.1","title":"Improve error messages in server actions (lib/create-actions.ts)","description":"## Files\n- lib/create-actions.ts (modify)\n- lib/repo-context.ts (modify)\n\n## What to do\n1. In `getRepoContext()` (repo-context.ts): when returning null, log a structured message. No throw needed since callers check null.\n2. In `create-actions.ts`: replace every `throw new Error(\"Unable to get repository context\")` (lines 84, 123, 142, 160, 178) with a message that includes the function name and operation, e.g. `throw new Error(\"addEvaluation failed: could not establish repository context. The user session may have expired or the target DID is unreachable.\")`. Each of the 5 occurrences should name its own function.\n3. `switchActiveProfile` line 32: change to `throw new Error(\"Cannot switch profiles: no active session found. Please log in first.\")`\n\n## Dont\n- Do not change function signatures or return types\n- Do not add new dependencies\n- Do not expose DIDs or internal IDs in the error message string","acceptance_criteria":"1. Each of the 5 \"Unable to get repository context\" errors now includes the function name and a human-readable reason.\n2. switchActiveProfile error mentions logging in.\n3. All existing tests (if any) still pass: `npm run build` succeeds.\n4. No new dependencies added.","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T18:08:43.417341174+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:12:44.367017986+06:00","closed_at":"2026-02-17T18:12:44.367017986+06:00","close_reason":"12f11f9 improve error messages in server actions and repo context","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-0h4.1","depends_on_id":"hypercerts-0h4","type":"parent-child","created_at":"2026-02-17T18:08:43.419018618+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-0h4.2","title":"Improve error messages in API route handlers","description":"## Files\n- app/api/certs/create/route.ts (modify)\n- app/api/certs/add-location/route.ts (modify)\n- app/api/certs/add-attachment/route.ts (modify)\n- app/api/profile/update/route.ts (modify)\n- app/api/profile/bsky/update/route.ts (modify)\n- app/api/auth/callback/route.ts (modify)\n- app/api/auth/logout/route.ts (modify)\n\n## What to do\nFor each API route catch block that returns a generic error JSON:\n1. `certs/create/route.ts` line 57-60: change `\"Error creating hypercert\"` to include the original error message: `\"Failed to create hypercert: ${(e as Error).message}\"`. The if-branch on line 54-55 already does this — just make the else-branch consistent.\n2. `certs/add-location/route.ts` line 21-29: the missing-field error message is buggy — it shows the fields that ARE present instead of the ones that are MISSING. Fix the ternary logic: `Missing${!locationType ? \" locationType\" : \"\"}${!lpVersion ? \" lpVersion\" : \"\"}${!srs ? \" srs\" : \"\"}`.\n3. `auth/callback/route.ts`: include the error type/message in the logged output (it already does `console.error` but check the redirect includes a useful `auth_error_description` param).\n4. `auth/logout/route.ts`: include error message in response: `\"Logout failed: ${(e as Error).message}\"`.\n5. `profile/update/route.ts` and `profile/bsky/update/route.ts`: ensure catch blocks return `{ error: \"Profile update failed: \u003creason\u003e\" }` not just generic messages.\n\n## Dont\n- Do not change HTTP status codes\n- Do not change request/response shapes (field names)\n- Do not add new dependencies","acceptance_criteria":"1. certs/add-location validation error correctly lists MISSING fields (not present ones).\n2. Every catch block in the 7 files returns an error message that includes the original Error.message.\n3. `npm run build` succeeds.\n4. No HTTP status codes changed.","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":45,"created_at":"2026-02-17T18:08:57.623378908+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:12:57.58991568+06:00","closed_at":"2026-02-17T18:12:57.58991568+06:00","close_reason":"4a0ef47 Improve error messages in API route handlers","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-0h4.2","depends_on_id":"hypercerts-0h4","type":"parent-child","created_at":"2026-02-17T18:08:57.625200023+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-0h4.3","title":"Improve error toasts in mutation hooks to show actual error reason","description":"## Files\n- queries/hypercerts/use-add-attachment-mutation.ts (modify)\n- queries/hypercerts/use-add-location-mutation.ts (modify)\n- queries/auth/use-login-mutation.ts (modify)\n- queries/auth/use-logout-mutation.ts (modify)\n- queries/profile/use-update-profile-mutation.ts (modify)\n- queries/profile/use-update-bsky-profile-mutation.ts (modify)\n- components/measurement-form.tsx (modify)\n- components/evaluation-form.tsx (modify)\n- components/contributions-form.tsx (modify)\n\n## What to do\nEach of these files has an `onError` handler that shows a generic toast like `toast.error(\"Failed to add attachment\")` while the actual error with a useful message is sitting right there in the `error` parameter. Apply this pattern to all of them:\n\n```ts\nonError: (error) =\u003e {\n  console.error(\"Add attachment error:\", error);\n  const message = error instanceof Error ? error.message : \"Unknown error\";\n  toast.error(`Failed to add attachment: ${message}`);\n},\n```\n\nSpecific files and their current generic messages to fix:\n- use-add-attachment-mutation.ts line 42: \"Failed to add attachment\"\n- use-add-location-mutation.ts line 35: \"Failed to add location\"  \n- use-login-mutation.ts line 18: \"An error occurred while logging in.\"\n- use-logout-mutation.ts line 18: \"Logout failed\"\n- measurement-form.tsx line 119: \"Failed to add measurement.\"\n- evaluation-form.tsx line 64: \"Failed to add evaluation\"\n- contributions-form.tsx line 108: \"Failed to create contribution\"\n\nNote: use-update-profile-mutation.ts and use-update-bsky-profile-mutation.ts already have the pattern `error instanceof Error ? error.message : fallback` — leave those as-is, they are fine.\n\n## Dont\n- Do not change the console.error lines\n- Do not change onSuccess handlers\n- Do not add new dependencies\n- Do not touch use-update-profile-mutation.ts or use-update-bsky-profile-mutation.ts (they already do this correctly)\n- Do not touch use-create-hypercert-mutation.ts (it already does this correctly)","acceptance_criteria":"1. All 7 listed onError handlers now include error.message in the toast string.\n2. use-update-profile-mutation.ts and use-update-bsky-profile-mutation.ts are NOT modified.\n3. use-create-hypercert-mutation.ts is NOT modified.\n4. `npm run build` succeeds.","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T18:09:11.866376784+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:15:17.544874959+06:00","closed_at":"2026-02-17T18:15:17.544874959+06:00","close_reason":"4a5cc49 Improve error toasts to include actual error message","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-0h4.3","depends_on_id":"hypercerts-0h4","type":"parent-child","created_at":"2026-02-17T18:09:11.868235319+06:00","created_by":"karma.gainforest.id"},{"issue_id":"hypercerts-0h4.3","depends_on_id":"hypercerts-0h4.2","type":"blocks","created_at":"2026-02-17T18:09:28.813024226+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-0h4.4","title":"Improve AuthErrorToast to show specific auth failure reasons","description":"## Files\n- providers/AuthErrorToast.tsx (modify)\n- app/api/auth/callback/route.ts (modify)\n\n## What to do\n1. In `AuthErrorToast.tsx`: the else-branch (line 21) falls back to \"Authentication failed. Please try again.\" when there is no `auth_error_description`. Improve this to at least include the `authError` code itself: `Authentication failed (${authError}). Please try again.` so the user sees something like \"Authentication failed (invalid_request). Please try again.\"\n2. In `callback/route.ts`: ensure that when redirecting on auth error, the `auth_error_description` query param is populated with the actual error message from the caught exception, not left empty.\n\n## Dont\n- Do not change the access_denied case (line 18-19), that message is fine\n- Do not add new dependencies","acceptance_criteria":"1. AuthErrorToast else-branch includes the error code in the displayed message.\n2. callback/route.ts sets auth_error_description in the redirect URL when an error occurs.\n3. `npm run build` succeeds.","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":20,"created_at":"2026-02-17T18:09:21.768834643+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:11:55.187895481+06:00","closed_at":"2026-02-17T18:11:55.187895481+06:00","close_reason":"676c9bb improve AuthErrorToast to show error code in fallback message","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-0h4.4","depends_on_id":"hypercerts-0h4","type":"parent-child","created_at":"2026-02-17T18:09:21.770563684+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-3mq","title":"Fix: nyk.13 refactor reverted all 4 desktop left-alignment changes from nyk.14","description":"Review of hypercerts-nyk.14 found: the nyk.13 refactor commit (ce6a9cf, merged after 9a98af1) rewrote lib/atproto-branding.ts and reverted all 4 alignment changes that nyk.14 made.\n\nCurrent HEAD state of lib/atproto-branding.ts has:\n1. Line 86 comment: 'Desktop: right aligned' (should say left)\n2. Line 96: background-position: right center (should be left center)\n3. Line 146: background-position: right center (should be left center)\n4. Line 781: justify-items: end (should be start)\n5. Line 786: text-align: right (should be left)\n\nAll 4 acceptance criteria of nyk.14 are now failing:\n- AC1: horizontal logo above H1 is NOT left-aligned on desktop (right center)\n- AC2: certified-signin.svg H1 image is NOT left-aligned on desktop (right center)\n- AC3: desktop .grid.grow.content-center uses justify-items: end (not start)\n- AC4: .md:text-right still forces text-align: right\n\nFix: re-apply the 4 changes from nyk.14 to the current HEAD of lib/atproto-branding.ts:\n  - background-position: left center for logo (line ~96)\n  - background-position: left center for H1 certified-signin.svg (line ~146)\n  - justify-items: start in desktop media query (line ~781)\n  - text-align: left for .md:text-right in desktop media query (line ~786)\n\nEvidence: git show 9a98af1 shows the correct changes; git show ce6a9cf shows the massive rewrite that overwrote them; current file confirmed via grep.","status":"open","priority":2,"issue_type":"bug","owner":"kzoepa@gmail.com","created_at":"2026-02-17T19:02:01.435663195+06:00","created_by":"kzoeps","updated_at":"2026-02-17T19:02:01.435663195+06:00","dependencies":[{"issue_id":"hypercerts-3mq","depends_on_id":"hypercerts-nyk.14","type":"discovered-from","created_at":"2026-02-17T19:02:05.623349672+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-5jk","title":"Fix: overly broad `img[alt*=\"Logo\"]` selector risks matching unintended images in atproto-branding.ts (from hypercerts-nyk.15)","description":"Review of hypercerts-nyk.15 found an overly broad CSS selector in lib/atproto-branding.ts.\n\nLines 94-95 and 120-123:\n```css\nimg[alt=\"Hypercerts Logo\"],\nimg[alt*=\"Logo\"] {   /* matches ANY image whose alt contains 'Logo' */\n  width: 200px !important;\n  height: 40px !important;\n  ...\n}\n\n@media (prefers-color-scheme: dark) {\n  img[alt=\"Hypercerts Logo\"],\n  img[alt*=\"Logo\"] {\n    filter: invert(1) !important;  /* inverts ALL such images */\n  }\n}\n```\n\nThe `img[alt*=\"Logo\"]` substring selector will match any image on the PDS OAuth pages whose alt text contains the word 'Logo' (case-sensitive). This could accidentally resize and invert partner logos, app icons, or any future image the PDS adds with 'Logo' in its alt text.\n\nThe intent is clearly to target only the Hypercerts app logo. The more specific `img[alt=\"Hypercerts Logo\"]` selector already covers the exact target.\n\nEvidence: lib/atproto-branding.ts lines 94-104 and 119-127.\n\nFix: Remove the `img[alt*=\"Logo\"]` fallback selector from both the base rule and the dark mode rule. Keep only `img[alt=\"Hypercerts Logo\"]`. If the PDS uses a different exact alt text, add that specific value instead of a substring match.","status":"open","priority":3,"issue_type":"bug","owner":"karma.gainforest.id","created_at":"2026-02-17T19:45:58.145044156+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:45:58.145044156+06:00","dependencies":[{"issue_id":"hypercerts-5jk","depends_on_id":"hypercerts-nyk.15","type":"discovered-from","created_at":"2026-02-17T19:46:01.668988638+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-5vs","title":"Fix: authenticate page logo width changed outside spec scope (from hypercerts-nyk.8)","description":"Review of hypercerts-nyk.8 found: commit 52ce32a changed the authenticate page logo width from 54px to 180px (desktop) and from 42px to 140px (mobile) in main.flex.flex-col.items-center \u003e h1.text-primary::before. The spec for hypercerts-nyk.8 explicitly states 'Don't: Change any color values or non-text-replacement CSS'. These logo width changes are out of scope for this task. Evidence: git show 52ce32a -- lib/atproto-branding.ts shows -width: 54px +width: 180px and -width: 42px +width: 140px in the authenticate page logo ::before block. These changes may be intentional improvements but were not part of the spec and violate the constraint. They should either be reverted or moved to a separate task with proper spec coverage.","status":"open","priority":3,"issue_type":"bug","owner":"kzoepa@gmail.com","created_at":"2026-02-17T17:01:02.24037314+06:00","created_by":"kzoeps","updated_at":"2026-02-17T17:01:02.24037314+06:00","dependencies":[{"issue_id":"hypercerts-5vs","depends_on_id":"hypercerts-nyk.8","type":"discovered-from","created_at":"2026-02-17T17:01:06.156873056+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-7v8","title":"Epic: Re-enable workScope in hypercert creation flow","description":"The workScope field was commented out across the hypercert creation pipeline. The form UI collects workScope tags, the client API sends them, but the server API route ignores them (commented out) and the form's getRecord() doesn't include workScope in the CreateHypercertParams object. Goal: wire workScope end-to-end so it flows from form → client API → server API route → SDK create call. The SDK's CreateHypercertParams.workScope accepts string | StrongRef (optional). For now we pass a comma-joined string of the tags.","notes":"Wrong scope — user meant OAuth scopes, not workScope field","status":"closed","priority":2,"issue_type":"epic","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","created_at":"2026-02-17T18:58:07.96248841+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:06:51.176403547+06:00","closed_at":"2026-02-17T19:06:51.176411943+06:00","labels":["scope:small"]}
{"id":"hypercerts-7v8.1","title":"Add workScope to getRecord() in hypercerts-base-form.tsx","description":"## Files\n- components/hypercerts-base-form.tsx (modify)\n\n## What to do\nIn the `getRecord()` function (around line 188), the returned `CreateHypercertParams` object is missing the `workScope` field. The `cleanedWorkScope` variable is already computed on line 153 (`const cleanedWorkScope = workScope.map((w) =\u003e w.trim()).filter(Boolean);`) but never used.\n\nAdd `workScope` to the record object. The SDK type `CreateHypercertParams.workScope` accepts `string | StrongRef | undefined`. Pass the cleaned work scope tags as a comma-joined string:\n\n```typescript\nconst record: CreateHypercertParams = {\n  title,\n  shortDescription,\n  rights: { ... },\n  description: shortDescription,\n  image: backgroundImage,\n  startDate: startDate.toISOString(),\n  endDate: endDate.toISOString(),\n  contributions,\n  workScope: cleanedWorkScope.length \u003e 0 ? cleanedWorkScope.join(\", \") : undefined,\n};\n```\n\n## Don't\n- Change the workScope UI inputs or state management — they already work\n- Change the type of workScope (keep it as a comma-joined string for now)\n- Remove or modify the cleanedWorkScope computation","acceptance_criteria":"1. The `getRecord()` function in `hypercerts-base-form.tsx` returns a `CreateHypercertParams` object that includes `workScope` when the user has entered work scope tags.\n2. When no work scope tags are entered, `workScope` is `undefined` (not an empty string).\n3. `npm run build` succeeds with no type errors.","notes":"Parent epic cancelled","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-17T18:58:21.95276996+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:06:51.230972771+06:00","closed_at":"2026-02-17T19:06:51.230979845+06:00","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-7v8.1","depends_on_id":"hypercerts-7v8","type":"parent-child","created_at":"2026-02-17T18:58:21.95441263+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-7v8.2","title":"Uncomment workScope parsing in API route app/api/certs/create/route.ts","description":"## Files\n- app/api/certs/create/route.ts (modify)\n\n## What to do\nLines 14-15 have the workScope parsing commented out:\n```typescript\n// TODO map to proper workscope\n// // const workScopeRaw = formData.get(\"workScope\") as string | null;\n```\n\nAnd line 36 has the workScope param commented out:\n```typescript\n// workScope,\n```\n\nUncomment and wire these back in:\n\n1. Uncomment the workScope extraction (remove the TODO comment too):\n```typescript\nconst workScopeRaw = formData.get(\"workScope\") as string | null;\n```\n\n2. Parse it — the client sends it as `JSON.stringify(params.workScope)` from `lib/api/hypercerts.ts`. Since `workScope` in `CreateHypercertParams` is `string | StrongRef | undefined`, and we're sending a simple string, parse it:\n```typescript\nconst workScope = workScopeRaw ? JSON.parse(workScopeRaw) : undefined;\n```\n\n3. Add `workScope` back to the `hypercertParams` object:\n```typescript\nconst hypercertParams: CreateHypercertParams = {\n  title,\n  shortDescription,\n  description: description ?? shortDescription,\n  workScope,\n  startDate,\n  endDate,\n  rights,\n  image: image || undefined,\n  contributions,\n};\n```\n\n## Don't\n- Change the FormData key name (must remain \"workScope\")\n- Add validation beyond what exists for other fields\n- Change how other fields are parsed","acceptance_criteria":"1. The `workScopeRaw` variable is extracted from formData (no longer commented out).\n2. The `workScope` field is included in the `hypercertParams` object passed to `ctx.scopedRepo.hypercerts.create()`.\n3. The TODO comment on line 14 is removed.\n4. `npm run build` succeeds with no type errors.","notes":"Parent epic cancelled","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-17T18:58:31.991816626+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:06:51.287562421+06:00","closed_at":"2026-02-17T19:06:51.287567741+06:00","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-7v8.2","depends_on_id":"hypercerts-7v8","type":"parent-child","created_at":"2026-02-17T18:58:31.993423348+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-84k","title":"Fix: unnecessary `position: relative` on Authenticate H1 in atproto-branding.ts (from hypercerts-nyk.15)","description":"Review of hypercerts-nyk.15 found an unnecessary CSS rule in lib/atproto-branding.ts.\n\nLine 232-234:\n```css\nmain.flex.flex-col.items-center \u003e h1.text-primary {\n  position: relative !important;\n}\n```\n\nThis `position: relative` is set to enable the `::before` pseudo-element logo. However, the `::before` pseudo-element (lines 236-246) uses `display: block` with `margin: 0 auto 24px auto` — it is in normal block flow, not absolutely positioned. A `position: relative` parent is only needed for `position: absolute` children. Since the `::before` is block-flow, the `position: relative` on the parent has no effect.\n\nEvidence: lib/atproto-branding.ts lines 232-246. The ::before pseudo-element has no `position: absolute` or `position: fixed`.\n\nFix: Remove the `position: relative !important` rule from `main.flex.flex-col.items-center \u003e h1.text-primary`. This also allows merging the two split rule blocks for this selector (lines 232-234 and 258-261) into one.","status":"open","priority":4,"issue_type":"bug","owner":"karma.gainforest.id","created_at":"2026-02-17T19:46:28.066268808+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:46:28.066268808+06:00","dependencies":[{"issue_id":"hypercerts-84k","depends_on_id":"hypercerts-nyk.15","type":"discovered-from","created_at":"2026-02-17T19:46:32.467819549+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-amn","title":"Remove build step from CI workflow, keep only lint and format check","description":"## Files\n- .github/workflows/ci.yml (modify)\n\n## What to do\nThe CI workflow currently runs `pnpm build` which fails because it requires environment variables (ATPROTO_JWK_PRIVATE, REDIS_HOST, etc.) that are not available in CI.\n\nRemove the build step entirely. Keep only lint and format check.\n\n### Current steps to keep:\n1. Checkout\n2. Install pnpm (via pnpm/action-setup@v4)\n3. Setup Node.js 20 with pnpm cache\n4. pnpm install --frozen-lockfile\n5. pnpm lint\n6. pnpm format:check\n\n### Step to REMOVE:\n- The \"Build\" step (`pnpm build`) — delete it entirely\n\n### Also update the job name:\n- Change `name: Build, Lint \u0026 Format Check` to `name: Lint \u0026 Format Check`\n\n## Don't\n- Change the trigger conditions (push to main, PR to main)\n- Change the concurrency settings\n- Change the Node.js version or pnpm setup\n- Add any new steps\n- Touch any other files","acceptance_criteria":"1. The CI workflow file at .github/workflows/ci.yml has NO build step (no `pnpm build` or `next build`)\n2. The workflow still runs `pnpm lint` and `pnpm format:check`\n3. The job name says \"Lint \u0026 Format Check\" (no \"Build\")\n4. The workflow YAML is valid (proper indentation, no syntax errors)\n5. All other workflow settings (triggers, concurrency, checkout, pnpm setup, node setup, install) are unchanged","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","estimated_minutes":10,"created_at":"2026-02-17T20:35:51.395690311+06:00","created_by":"kzoeps","updated_at":"2026-02-17T20:36:51.469815209+06:00","closed_at":"2026-02-17T20:36:51.469815209+06:00","close_reason":"d90661f remove build step from CI workflow","labels":["scope:trivial"]}
{"id":"hypercerts-b08","title":"Epic: Fix creation flow step numbering and profile picture blank after update","description":"Two UI bugs need fixing: (1) The creation flow shows 'Step X of 6' in form components but only 5 steps exist (Contributions step was commented out). The stepper sidebar is correct at 5 steps but the hardcoded stepLabel props in each form and skeleton are stale. (2) After updating a profile picture, the image goes blank because the API returns raw blob URLs instead of CDN-converted URLs. On page refresh it works because the server component applies convertBlobUrlToCdn(). Success looks like: step labels all say 'of 5' consistently, and profile picture remains visible immediately after save without requiring a refresh.","status":"closed","priority":1,"issue_type":"epic","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","created_at":"2026-02-17T16:30:02.626885397+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:34:30.991521307+06:00","closed_at":"2026-02-17T16:34:30.942229502+06:00","close_reason":"b9895a8 Both child tasks completed — step labels and profile picture CDN fixes","labels":["needs-integration-review"]}
{"id":"hypercerts-b08.1","title":"Fix hardcoded step labels in creation flow forms and skeletons","description":"## Files\n- components/evidence-form.tsx (modify)\n- components/locations-form.tsx (modify)\n- components/measurement-form.tsx (modify)\n- components/evaluation-form.tsx (modify)\n- components/contributions-form.tsx (modify)\n- components/form-skeletons.tsx (modify)\n\n## What to do\nThe Contributions step (originally step 2) was commented out in app/hypercerts/create/page.tsx while the SDK stabilizes. The stepper sidebar in edit-cert-stepper.tsx correctly defines 5 steps, but the individual form components still have hardcoded stepLabel props saying \"of 6\" with wrong step numbers.\n\nUpdate the stepLabel prop in each form component to match the current 5-step flow:\n\n1. **evidence-form.tsx** line ~211: change `stepLabel=\"Step 3 of 6\"` → `stepLabel=\"Step 2 of 5\"`\n2. **locations-form.tsx** line ~113: change `stepLabel=\"Step 4 of 6\"` → `stepLabel=\"Step 3 of 5\"`\n3. **measurement-form.tsx** line ~291: change `stepLabel=\"Step 5 of 6\"` → `stepLabel=\"Step 4 of 5\"`\n4. **evaluation-form.tsx** line ~188: change `stepLabel=\"Step 6 of 6\"` → `stepLabel=\"Step 5 of 5\"`\n5. **contributions-form.tsx** line ~136: change `stepLabel=\"Step 2 of 6\"` → `stepLabel=\"Step 2 of 6\"` (leave as-is since it is commented out, but add a TODO comment: `// TODO: update stepLabel when contributions step is re-enabled`)\n6. **form-skeletons.tsx**: Update all skeleton stepLabels to match:\n   - ContributionFormSkeleton (~line 119): leave as-is (commented out step) but add TODO\n   - EvidenceFormSkeleton (~line 153): ensure says \"Step 2 of 5\"\n   - LocationFormSkeleton (~line 205): ensure says \"Step 3 of 5\"\n   - MeasurementFormSkeleton (~line 252): ensure says \"Step 4 of 5\"\n   - EvaluationFormSkeleton (~line 302): ensure says \"Step 5 of 5\"\n\n## Dont\n- Do NOT change the STEPS array in edit-cert-stepper.tsx (it is already correct)\n- Do NOT uncomment or re-enable the contributions step\n- Do NOT change the step state logic in app/hypercerts/create/page.tsx\n- Do NOT refactor stepLabel to be dynamic — just fix the hardcoded strings for now","acceptance_criteria":"All 4 active form components show correct step labels: \"Step 2 of 5\", \"Step 3 of 5\", \"Step 4 of 5\", \"Step 5 of 5\". All 4 active skeleton components match. No form says \"of 6\". The app builds without errors (npm run build or next build succeeds).","status":"closed","priority":1,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T16:30:19.833303835+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:33:53.907122747+06:00","closed_at":"2026-02-17T16:33:53.907122747+06:00","close_reason":"391e426 Fix hardcoded step labels to match 5-step flow","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-b08.1","depends_on_id":"hypercerts-b08","type":"parent-child","created_at":"2026-02-17T16:30:19.835388129+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-b08.2","title":"Fix profile picture going blank after update by applying CDN URL conversion","description":"## Files\n- app/api/profile/update/route.ts (modify)\n- app/api/profile/bsky/update/route.ts (modify)\n- providers/SignedInProvider.tsx (modify)\n\n## What to do\nAfter a profile picture update, the image goes blank because the API response returns raw blob URLs (e.g. XRPC getBlob URLs from PDS hosts) that are not in Next.js allowed remotePatterns. The server-side profile page (app/profile/page.tsx) correctly applies `convertBlobUrlToCdn()` from `lib/utils.ts` before passing URLs as props, but the API routes do not.\n\n### Fix 1: app/api/profile/update/route.ts\nAround lines 99-115, the route fetches the updated profile and returns avatar/banner URLs. Currently:\n```ts\nconst avatarUrl = updated?.avatar || \"\";\nconst bannerUrl = updated?.banner || \"\";\n```\nChange to:\n```ts\nimport { convertBlobUrlToCdn } from \"@/lib/utils\";\n// ...\nconst avatarUrl = convertBlobUrlToCdn(updated?.avatar) || \"\";\nconst bannerUrl = convertBlobUrlToCdn(updated?.banner) || \"\";\n```\n\n### Fix 2: app/api/profile/bsky/update/route.ts\nSame pattern — find where avatar and banner URLs are returned (around lines 86-87) and apply `convertBlobUrlToCdn()` to both.\n\n### Fix 3: providers/SignedInProvider.tsx\nAround line 30, the Navbar avatar URL is set from the raw profile:\n```ts\navatarUrl = profile?.avatar;\n```\nChange to:\n```ts\nimport { convertBlobUrlToCdn } from \"@/lib/utils\";\n// ...\navatarUrl = convertBlobUrlToCdn(profile?.avatar) || \"\";\n```\n\n## Dont\n- Do NOT change the convertBlobUrlToCdn function itself\n- Do NOT modify the profile-form.tsx onSuccess handler (the fix should come from the API returning correct URLs)\n- Do NOT modify app/profile/page.tsx (it already works correctly)\n- Do NOT add new entries to next.config.ts remotePatterns — the CDN URL conversion is the correct approach\n- Do NOT change the ImageUploader component","acceptance_criteria":"After updating a profile picture on the /profile page, the new image remains visible immediately without requiring a page refresh. The Navbar avatar also updates correctly. The app builds without errors (npm run build or next build succeeds). Verify that convertBlobUrlToCdn is imported and applied in all three files.","status":"closed","priority":1,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T16:30:30.574689694+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:33:58.96474815+06:00","closed_at":"2026-02-17T16:33:58.96474815+06:00","close_reason":"772956d Apply CDN URL conversion to profile picture API routes and Navbar","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-b08.2","depends_on_id":"hypercerts-b08","type":"parent-child","created_at":"2026-02-17T16:30:30.577364056+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-b08.3","title":"Fix avatar camera icon getting clipped on profile page","description":"## Files\n- components/image-uploader.tsx (modify)\n\n## What to do\nWhen the avatar has an image, the camera icon overlay button (the edit/replace button) is positioned at `bottom-0 right-0` inside a container that has `overflow-hidden` and `rounded-full`. Because the circle clips the corners, the camera button gets cut off — it sits in the corner of the bounding box but the circle masks it.\n\nThe fix: move the camera icon button **outside** the overflow-hidden container so it is not clipped, but still visually anchored to the bottom-right of the avatar circle.\n\n### Approach\nIn `image-uploader.tsx`, for the `aspect=\"square\"` (avatar) case only:\n\n1. The camera button (lines 65-74) needs to sit outside the `overflow-hidden` container but still be positioned relative to it. The simplest approach: wrap the entire component in a `relative` container and move the camera button to be a sibling of the overflow-hidden div rather than a child of it. \n\n2. Specifically for the avatar case (`!isBanner`), the camera button should be positioned at the bottom-right edge of the circle. A good position is `bottom-0 right-0` on the outer relative wrapper (which does NOT have overflow-hidden).\n\n3. For the banner case (`isBanner`), keep the current behavior (`bottom-2 right-2` inside the overflow container) since banners are rectangular and dont clip.\n\n4. Make sure the camera button circle is fully visible — the entire round button with the camera icon should be shown, not cut off.\n\n### Current structure (simplified):\n```\n\u003cdiv class=\"overflow-hidden rounded-full\"\u003e \u003c!-- clips everything --\u003e\n  \u003cImage /\u003e\n  \u003cbutton class=\"bottom-0 right-0\"\u003e \u003c!-- gets clipped --\u003e\n    \u003cCamera /\u003e\n  \u003c/button\u003e\n\u003c/div\u003e\n```\n\n### Target structure for avatar:\n```\n\u003cdiv class=\"relative\"\u003e \u003c!-- no overflow-hidden, positions the button --\u003e\n  \u003cdiv class=\"overflow-hidden rounded-full\"\u003e \u003c!-- clips only the image --\u003e\n    \u003cImage /\u003e\n  \u003c/div\u003e\n  \u003cbutton class=\"absolute bottom-0 right-0 z-10\"\u003e \u003c!-- not clipped --\u003e\n    \u003cCamera /\u003e\n  \u003c/button\u003e\n\u003c/div\u003e\n```\n\nFor banner, keep the button inside the overflow container as it is today.\n\n## Dont\n- Do NOT change the avatar size (w-24 h-24)\n- Do NOT change the banner layout or positioning\n- Do NOT change the profile-form.tsx file\n- Do NOT remove the ring-4 ring-background styling (that comes from profile-form.tsx parent)\n- Do NOT change the camera icon size or styling (bg-black/40, backdrop-blur, etc.) — only change its positioning/nesting","acceptance_criteria":"The camera icon button on the avatar is fully visible as a complete circle — not clipped by the rounded avatar container. The button remains clickable and triggers file selection. The banner camera icon still works correctly (bottom-right corner inside the banner). The app builds without errors.","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":20,"created_at":"2026-02-17T16:57:29.35499163+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:59:15.455978468+06:00","closed_at":"2026-02-17T16:59:15.455978468+06:00","close_reason":"3eb6e49 Fix avatar camera icon clipped by overflow-hidden container","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-b08.3","depends_on_id":"hypercerts-b08","type":"parent-child","created_at":"2026-02-17T16:57:29.357597993+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-bu9","title":"Fix: duplicate inputRef causes upload label broken in no-image state (from hypercerts-b08.3)","description":"Review of hypercerts-b08.3 found: two \u003cinput ref={inputRef}\u003e elements are rendered simultaneously when imageUrl is falsy (no-image state). Lines 89-95 (inside the \u003clabel\u003e) and lines 100-106 (always-rendered hidden input) both use ref={inputRef}. React assigns the ref to the last-rendered element (lines 100-106), which is outside the \u003clabel\u003e. The label wraps the first input but inputRef points to the second, so clicking the upload label in the no-image state may not trigger file selection correctly. Evidence: components/image-uploader.tsx lines 89-106 in commit 3eb6e49. Fix: remove the always-rendered hidden input (lines 100-106) since the label-wrapped input (lines 89-95) already handles the no-image case, and the avatar camera button (lines 110-118) calls inputRef.current?.click() directly which works fine without a second input.","acceptance_criteria":"Only one \u003cinput ref={inputRef}\u003e element exists in image-uploader.tsx at any time. File upload works in both states: (1) clicking the dashed upload area when no image is set triggers file selection, (2) clicking the camera icon button when an image exists triggers file selection. The app builds without errors.","status":"closed","priority":2,"issue_type":"bug","assignee":"karma.gainforest.id","owner":"kzoepa@gmail.com","created_at":"2026-02-17T17:04:19.608809781+06:00","created_by":"kzoeps","updated_at":"2026-02-17T17:08:46.23134294+06:00","closed_at":"2026-02-17T17:08:46.23134294+06:00","close_reason":"c54bd52 fix: remove duplicate inputRef — single hidden input always rendered","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-bu9","depends_on_id":"hypercerts-b08.3","type":"discovered-from","created_at":"2026-02-17T17:04:23.638372534+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-c28","title":"Epic: Fix all pre-existing ESLint errors and warnings","description":"The codebase has 84 ESLint problems (6 errors, 78 warnings) after autofix. Most warnings (50+) come from auto-generated lexicons/ files that should be excluded from linting. The remaining ~30 issues are unused imports/vars and no-explicit-any errors in source files. Goal: zero ESLint errors, minimal warnings. Success: npm run lint exits with 0 errors and 0 warnings. Scope: ESLint config ignore for lexicons, remove unused imports, add proper types for any. Out of scope: changing ESLint rules, adding new plugins.","status":"closed","priority":2,"issue_type":"epic","owner":"karma.gainforest.id","created_at":"2026-02-17T18:57:45.568710354+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:08:04.893916104+06:00","closed_at":"2026-02-17T19:08:04.893916104+06:00","close_reason":"0476c57 All ESLint errors and warnings resolved — 0 problems","labels":["scope:small"]}
{"id":"hypercerts-c28.1","title":"Add lexicons/ to ESLint globalIgnores","description":"## Files\n- eslint.config.mjs (modify)\n\n## What to do\n\nAdd `\"lexicons/**\"` to the `globalIgnores` array in `eslint.config.mjs`. The lexicons/ directory contains auto-generated TypeScript types from ATProto lexicon definitions. These files have many unused imports by design (they export types that consumers may or may not use). They should not be linted.\n\nThe globalIgnores array currently has:\n```js\nglobalIgnores([\n  \".next/**\",\n  \"out/**\",\n  \"build/**\",\n  \"next-env.d.ts\",\n])\n```\n\nAdd `\"lexicons/**\"` to this array.\n\n## Don't\n- Do NOT modify any files in lexicons/\n- Do NOT change any ESLint rules\n- Do NOT touch any other config","acceptance_criteria":"1. eslint.config.mjs has \"lexicons/**\" in the globalIgnores array\n2. npm run lint no longer reports any warnings from lexicons/ files\n3. npm run lint still reports issues in non-lexicon files (i.e. we did not accidentally ignore too much)\n4. npx tsc --noEmit passes","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":5,"created_at":"2026-02-17T18:58:12.848981311+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:01:10.848866351+06:00","closed_at":"2026-02-17T19:01:10.848866351+06:00","close_reason":"4155910 Add lexicons/** to ESLint globalIgnores","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-c28.1","depends_on_id":"hypercerts-c28","type":"parent-child","created_at":"2026-02-17T18:58:12.850921725+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-c28.2","title":"Fix no-explicit-any errors across 3 files","description":"## Files\n- lib/blob-utils.ts (modify)\n- app/api/certs/add-attachment/route.ts (modify)\n- components/evidence-form.tsx (modify)\n\n## What to do\n\n### 1. lib/blob-utils.ts — 3 `any` usages (lines 31, 33, 51)\n\nThe function `resolveRecordBlobs` recursively walks an object tree resolving BlobRefs to URLs. It genuinely handles unknown shapes, so use `unknown` for the input and `Record\u003cstring, unknown\u003e` for the result object.\n\n```ts\n// Line 30-31: Change parameter type\nexport async function resolveRecordBlobs(\n  value: unknown,\n  ownerDid: string,\n): Promise\u003cunknown\u003e {\n```\n\nLine 34: the `typeof value !== \"object\"` check already narrows. But you need to handle the object access. After the null/typeof check, cast to `Record\u003cstring, unknown\u003e`:\n\n```ts\nif (!value || typeof value !== \"object\") return value;\n\nconst obj = value as Record\u003cstring, unknown\u003e;\n\n// Line 42: use obj instead of value\nif (obj.$type === \"blob\" || (obj.ref \u0026\u0026 obj.mimeType)) {\n  return await resolveBlobToUrl(obj as BlobRef | { $type: string }, ownerDid);\n}\n\n// Line 47-54: use obj\nconst entries = Object.entries(obj);\nconst resolved = await Promise.all(\n  entries.map(([, val]) =\u003e resolveRecordBlobs(val, ownerDid)),\n);\nconst result: Record\u003cstring, unknown\u003e = {};\nentries.forEach(([key], i) =\u003e {\n  result[key] = resolved[i];\n});\nreturn result;\n```\n\n### 2. app/api/certs/add-attachment/route.ts — 2 `any` usages (lines 72, 122)\n\nLine 72: `let location: any = undefined;`\n→ Change to a proper type. The location can be either a string or an object with specific fields:\n```ts\nlet location:\n  | string\n  | {\n      lpVersion: string;\n      srs: string;\n      locationType: string;\n      location: string | File;\n      name?: string;\n      description?: string;\n    }\n  | undefined = undefined;\n```\n\nLine 122: `contentType: contentType as any`\n→ The contentType comes from form data as a string. Check what the SDK method expects. If it is a union of string literals, cast to that type. If the type is not easily importable, use a type assertion through `unknown`:\n```ts\ncontentType: contentType as Parameters\u003ctypeof ctx.scopedRepo.hypercerts.addAttachment\u003e[0][\"contentType\"],\n```\nOr if that is too complex, prefix with an eslint-disable comment for just that line:\n```ts\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ncontentType: contentType as any,\n```\nUse the eslint-disable ONLY as a last resort if the SDK type is not accessible.\n\n### 3. components/evidence-form.tsx — 1 `any` usage (line 159)\n\nLine 159: `!CONTENT_TYPES.includes(contentType as any)`\n→ This is a type narrowing issue. `CONTENT_TYPES` is likely a `readonly` array and `contentType` is `string`. Fix by checking membership differently:\n```ts\nif (contentType \u0026\u0026 !(CONTENT_TYPES as readonly string[]).includes(contentType)) {\n```\n\n## Don't\n- Do NOT change any logic or behavior\n- Do NOT add eslint-disable comments unless absolutely necessary (SDK types not accessible)\n- Do NOT modify function signatures that are part of the public API unless the change is backward-compatible","acceptance_criteria":"1. npm run lint reports 0 errors for no-explicit-any in these 3 files\n2. npx tsc --noEmit passes\n3. No logic changes — only type annotations changed\n4. No eslint-disable comments added (unless the SDK type for contentType is truly inaccessible, in which case document why)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":25,"created_at":"2026-02-17T18:58:37.219922107+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:02:45.658012941+06:00","closed_at":"2026-02-17T19:02:45.658012941+06:00","close_reason":"6c729a4 fix: replace no-explicit-any with proper types in 3 files","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-c28.2","depends_on_id":"hypercerts-c28","type":"parent-child","created_at":"2026-02-17T18:58:37.221662402+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-c28.3","title":"Remove all unused imports and variables from source files","description":"## Files (all modify)\n- app/api/profile/bsky/update/route.ts\n- app/api/profile/update/route.ts\n- app/hypercerts/page.tsx\n- app/jwks.json/route.ts\n- app/page.tsx\n- app/profile/page.tsx\n- components/edit-cert-stepper.tsx\n- components/hypercert-detail-view.tsx\n- components/hypercert-evaluations-section.tsx\n- components/hypercert-evidence-section.tsx\n- components/hypercert-evidence-view.tsx\n- components/hypercert-measurements-section.tsx\n- components/hypercerts-base-form.tsx\n- components/login-dialog.tsx\n- components/navbar.tsx\n- lexicons/index.ts (only if not already ignored by ESLint after hypercerts-c28.1)\n- lib/api/external/bluesky.ts\n- lib/create-actions.ts\n- lib/utils.ts\n- providers/SignedInProvider.tsx\n\n## What to do\n\nRemove every unused import and unused variable flagged by ESLint `@typescript-eslint/no-unused-vars`. Also fix the one `@next/next/no-img-element` warning. Here is the exact list per file:\n\n### Simple unused imports (just delete the import or remove from destructure):\n- `app/hypercerts/page.tsx:5` — remove `CardContent` from import\n- `app/page.tsx:4` — remove `Badge` from import\n- `app/profile/page.tsx:3` — remove `getSession` from import\n- `app/profile/page.tsx:5` — remove `getBlobURL` from import\n- `components/edit-cert-stepper.tsx:5` — remove `Users` from import\n- `components/hypercert-detail-view.tsx:3` — remove `Separator` from import\n- `components/hypercert-detail-view.tsx:11` — remove `Award` from import\n- `components/hypercert-evaluations-section.tsx:8` — remove `Separator` from import\n- `components/hypercert-evidence-section.tsx:6` — remove `Separator` from import\n- `components/hypercert-evidence-view.tsx:16` — remove `OrgHypercertsDefs` from import\n- `components/hypercert-measurements-section.tsx:8` — remove `Separator` from import\n- `lib/api/external/bluesky.ts:5` — remove `APIError` from import\n- `lib/create-actions.ts:6` — remove `revalidatePath` import entirely\n- `lib/create-actions.ts:8` — remove `after` import entirely\n- `lib/utils.ts:7` — remove `sdk` import\n- `lib/utils.ts:8` — remove `OAuthSession` from import\n- `providers/SignedInProvider.tsx:4` — remove `getBlobURL` from import\n\n### Unused destructured variables (prefix with underscore or remove):\n- `app/api/profile/bsky/update/route.ts:38` — `catch (error)` → `catch`  (remove the binding since error is unused)\n- `app/api/profile/update/route.ts:46` — same pattern, `catch (error)` → `catch`\n- `app/jwks.json/route.ts:39-41` — `d`, `use`, `key_ops` are intentionally destructured to EXCLUDE them from the spread. Prefix with underscores: `_d`, `_use`, `_key_ops`\n- `components/hypercert-evidence-view.tsx:30` — `type` param in `getContentTypeColor` is unused. Prefix with underscore: `_type`\n- `lib/create-actions.ts:57` — `params` in `addContribution` is unused. Prefix with underscore: `_params`\n\n### Unused assigned variables (remove the assignment or the variable):\n- `components/edit-cert-stepper.tsx:32` — `isUpcoming` is assigned but never used. Delete the line `const isUpcoming = step \u003c s.id;`\n- `components/hypercerts-base-form.tsx:153` — `cleanedWorkScope` is assigned but never used. Delete the line `const cleanedWorkScope = workScope.map((w) =\u003e w.trim()).filter(Boolean);`\n- `components/login-dialog.tsx:22` — `hostname` is assigned but never used. Delete the line and its usage\n- `components/navbar.tsx:44-45` — `userDid` and `activeDid` are destructured from props but never used. Remove them from the destructure. Check if NavbarProps interface still needs them (they may be passed from parent but unused in this component — if so, also remove from the interface, but ONLY if no other component uses NavbarProps)\n\n### no-img-element (1 instance):\n- `components/hypercerts-base-form.tsx:352` — Replace `\u003cimg\u003e` with `\u003cImage\u003e` from `next/image`. Add `import Image from \"next/image\"` if not already imported. The `\u003cimg\u003e` tag needs `width` and `height` props for `\u003cImage\u003e`. Check the context to determine appropriate values.\n\n### lexicons/ files\n- If `lexicons/` is already ignored by ESLint (from hypercerts-c28.1), skip all lexicons/ files\n- If not yet ignored, skip them anyway — they are auto-generated\n\n## Don't\n- Do NOT change any logic or behavior\n- Do NOT remove variables/imports that ARE used (double-check before removing)\n- Do NOT modify lexicons/ files (they are auto-generated)\n- Do NOT change ESLint config\n- Do NOT remove props from component interfaces if they are passed by callers (even if unused in the component — they may be needed later). Instead prefix with underscore.","acceptance_criteria":"1. npm run lint reports 0 warnings for no-unused-vars in non-lexicon files\n2. npm run lint reports 0 warnings for no-img-element\n3. npx tsc --noEmit passes\n4. No logic or behavior changes — only dead code removed\n5. All removed imports/variables were genuinely unused (verify each one)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T18:59:58.894079326+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:07:00.866322756+06:00","closed_at":"2026-02-17T19:07:00.866322756+06:00","close_reason":"6286af9 Remove all unused imports and variables from source files","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-c28.3","depends_on_id":"hypercerts-c28","type":"parent-child","created_at":"2026-02-17T18:59:58.896233832+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-c3t","title":"Refactor: consolidate 5 scattered `@media (prefers-color-scheme: dark)` blocks in atproto-branding.ts (from hypercerts-nyk.15)","description":"Review of hypercerts-nyk.15 found that lib/atproto-branding.ts now has 5 separate `@media (prefers-color-scheme: dark)` blocks scattered across the file (lines 119-127, 171-175, 207-226, 264-268, 337-348). This is a maintainability concern — a developer reading the file must scan all 437 lines to understand the full dark mode behavior.\n\nAdditionally, the `main.flex.flex-col.items-center \u003e h1.text-primary` selector appears in two separate unconditional rule blocks (lines 232-234 and 258-261) that could be merged into one.\n\nEvidence: lib/atproto-branding.ts — count of dark media queries:\n- Lines 119-127: logo invert\n- Lines 171-175: H1 signin SVG swap\n- Lines 207-226: left panel background + text colors\n- Lines 264-268: Authenticate H1 color\n- Lines 337-348: button visibility\n\nRecommendation: Consolidate into 1-2 dark mode blocks (one for structural/layout rules, one for color overrides), or at minimum add a table-of-contents comment at the top listing all dark mode overrides. Also merge the split `main.flex.flex-col.items-center \u003e h1.text-primary` rules at lines 232-234 and 258-261 into a single block.\n\nThis is a refactor/cleanup task, not a functional bug.","status":"open","priority":4,"issue_type":"task","owner":"karma.gainforest.id","created_at":"2026-02-17T19:46:13.986219082+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:46:13.986219082+06:00","dependencies":[{"issue_id":"hypercerts-c3t","depends_on_id":"hypercerts-nyk.15","type":"discovered-from","created_at":"2026-02-17T19:46:18.157191988+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-c7v","title":"Fix: redundant `background-position: left center` in mobile logo override in atproto-branding.ts (from hypercerts-nyk.15)","description":"Review of hypercerts-nyk.15 found a redundant CSS declaration in lib/atproto-branding.ts.\n\nLine 112 in the mobile media query:\n```css\n@media (max-width: 767px) {\n  img[alt=\"Hypercerts Logo\"],\n  img[alt*=\"Logo\"] {\n    width: 150px !important;\n    height: 30px !important;\n    background-position: left center !important;  /* REDUNDANT */\n    margin-top: 8px !important;\n    margin-bottom: 8px !important;\n  }\n}\n```\n\nThe base rule (lines 94-104) already sets `background-position: left center !important`. The mobile override repeats the same value — it doesn't change anything. This is dead CSS that adds noise.\n\nEvidence: lib/atproto-branding.ts line 103 (base rule) vs line 112 (mobile override).\n\nFix: Remove `background-position: left center !important` from the mobile override block. Only the properties that actually differ from the base rule (width, height, margin-top, margin-bottom) need to be in the override.","status":"open","priority":4,"issue_type":"bug","owner":"karma.gainforest.id","created_at":"2026-02-17T19:47:18.882310696+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:47:18.882310696+06:00","dependencies":[{"issue_id":"hypercerts-c7v","depends_on_id":"hypercerts-nyk.15","type":"discovered-from","created_at":"2026-02-17T19:47:23.074664826+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-eig","title":"Fix: Internal error messages exposed in URL via auth_error_description (from hypercerts-jsu.1)","description":"Review of hypercerts-jsu.1 found: When sdk.callback() throws, the raw error message is placed in the auth_error_description URL query param (app/api/auth/callback/route.ts line 40: e instanceof Error ? e.message : 'An unexpected error occurred'). This can expose internal error details (OAuth state, internal URLs, library internals) in the browser address bar and server logs. Evidence: git show 1f18629 -- app/api/auth/callback/route.ts shows the catch block sets auth_error_description to e.message directly. Fix: use a generic user-facing message for callback_failed errors (e.g. 'Authentication failed. Please try again.') and log the full error server-side only. The error_description from the PDS (access_denied path) is fine to pass through as it is a standard OAuth param.","acceptance_criteria":"1. In the catch block of app/api/auth/callback/route.ts, auth_error_description is set to a generic string like \"Authentication failed. Please try again.\" — NOT e.message\n2. The full error is still logged server-side via console.error (already exists, just verify it stays)\n3. The access_denied early-return path (lines 9-17) is UNCHANGED — PDS-provided error_description is fine to pass through\n4. TypeScript compiles: npx tsc --noEmit passes\n5. No other files modified","status":"closed","priority":3,"issue_type":"bug","assignee":"karma.gainforest.id","owner":"kzoepa@gmail.com","estimated_minutes":10,"created_at":"2026-02-17T18:26:46.108263718+06:00","created_by":"kzoeps","updated_at":"2026-02-17T18:29:29.358588231+06:00","closed_at":"2026-02-17T18:29:29.358588231+06:00","close_reason":"7026ba9 fix: use generic message for callback_failed auth_error_description","dependencies":[{"issue_id":"hypercerts-eig","depends_on_id":"hypercerts-jsu.1","type":"discovered-from","created_at":"2026-02-17T18:26:48.972287885+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jgh","title":"Fix: dead `color: #ffffff` rule on ::after pseudo-element in atproto-branding.ts (from hypercerts-nyk.15)","description":"Review of hypercerts-nyk.15 found a dead CSS rule at line 167 of lib/atproto-branding.ts.\n\nThe rule:\n```css\n.grid h1.text-primary::after {\n  ...\n  color: #ffffff !important;  /* line 167 — DEAD RULE */\n}\n```\n\nThe `::after` pseudo-element has `content: \"\"` (empty string) and renders only a background-image (the certified-signin SVG). The `color` property has no effect on a pseudo-element with no text content. This is a leftover artifact from a previous iteration where the pseudo-element may have had text content.\n\nEvidence: lib/atproto-branding.ts lines 156-168. The pseudo-element uses background-image, not text, so color is irrelevant.\n\nFix: Remove the `color: #ffffff !important` line from `.grid h1.text-primary::after`.","status":"open","priority":3,"issue_type":"bug","owner":"karma.gainforest.id","created_at":"2026-02-17T19:45:42.302832017+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:45:42.302832017+06:00","dependencies":[{"issue_id":"hypercerts-jgh","depends_on_id":"hypercerts-nyk.15","type":"discovered-from","created_at":"2026-02-17T19:45:46.485905551+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-jsu","title":"Epic: Handle OAuth rejection gracefully","description":"When a user rejects the ATProto OAuth authorization, the callback URL includes error=access_denied. Currently the callback route lets sdk.callback() throw and returns raw JSON ({error, details}) to the browser — terrible UX. Goal: detect the error param early in the callback route, redirect the user back to / with a query param like ?auth_error=access_denied, and show a toast on the client side explaining what happened. The user should land back on the login screen seamlessly. Success: rejecting auth on the PDS shows a toast and the login dialog, not raw JSON. Scope: callback route early-return + client-side toast. Out of scope: new error pages, middleware, changes to the login flow itself.","status":"closed","priority":2,"issue_type":"epic","owner":"karma.gainforest.id","created_at":"2026-02-17T18:03:59.465100302+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:07:04.042012473+06:00","closed_at":"2026-02-17T18:07:04.042012473+06:00","close_reason":"5443dae All tasks completed — OAuth rejection redirects to / with toast","labels":["scope:small"]}
{"id":"hypercerts-jsu.1","title":"Handle OAuth error params in callback route and show client-side toast","description":"## Files\n- app/api/auth/callback/route.ts (modify)\n- providers/SignedInProvider.tsx (modify)\n\n## What to do\n\n### 1. Callback route: early-detect error param (app/api/auth/callback/route.ts)\n\nAt the top of the GET handler, BEFORE calling `sdk.callback(searchParams)`, check if `searchParams` has an `error` param. If it does:\n\n```ts\nconst error = searchParams.get(\"error\");\nif (error) {\n  const description = searchParams.get(\"error_description\") || \"Authorization was cancelled\";\n  console.warn(\"OAuth authorization error:\", error, description);\n  // Redirect back to home with error info for the client to display\n  const redirectUrl = new URL(\"/\", config.baseUrl);\n  redirectUrl.searchParams.set(\"auth_error\", error);\n  redirectUrl.searchParams.set(\"auth_error_description\", description);\n  return NextResponse.redirect(redirectUrl);\n}\n```\n\nAlso update the existing catch block to redirect instead of returning JSON:\n```ts\ncatch (e) {\n  console.error(\"Authentication failed:\", e);\n  const redirectUrl = new URL(\"/\", config.baseUrl);\n  redirectUrl.searchParams.set(\"auth_error\", \"callback_failed\");\n  redirectUrl.searchParams.set(\"auth_error_description\", e instanceof Error ? e.message : \"An unexpected error occurred\");\n  return NextResponse.redirect(redirectUrl);\n}\n```\n\n### 2. Client-side toast in SignedInProvider (providers/SignedInProvider.tsx)\n\nThis component already wraps all pages. Add a `useEffect` that:\n- Reads `auth_error` and `auth_error_description` from the URL search params (use `useSearchParams()` from next/navigation)\n- If `auth_error` is present, show a toast:\n  - If `auth_error === \"access_denied\"`: `toast.error(\"Login cancelled. You can try again when you're ready.\")`\n  - Otherwise: `toast.error(auth_error_description || \"Authentication failed. Please try again.\")`\n- Clean the URL by calling `router.replace(pathname)` (use `usePathname()` and `useRouter()` from next/navigation) to remove the query params\n- The useEffect should depend on searchParams\n\nNote: SignedInProvider currently receives `session` as a prop from the server. The toast logic should run regardless of whether session exists (the user will have no session after a rejection). If SignedInProvider is a server component, you may need to extract the toast logic into a small client component like `AuthErrorToast` and render it inside SignedInProvider.\n\nImport `toast` from `sonner` (already used elsewhere in the project, e.g. in components/navbar.tsx).\n\n## Don't\n- Do NOT create new pages or error boundary files\n- Do NOT modify the login flow (api/auth/login, use-login-mutation, etc.)\n- Do NOT add middleware\n- Do NOT change the successful auth flow at all\n- Do NOT install new dependencies — sonner and next/navigation are already available","acceptance_criteria":"1. When a user rejects OAuth authorization on the PDS, they are redirected to / (not shown raw JSON)\n2. A toast notification appears explaining the login was cancelled\n3. The URL is cleaned (no auth_error params remain in the address bar)\n4. When sdk.callback() throws for any other reason, the user is also redirected to / with a toast (not raw JSON)\n5. The successful auth flow (approve on PDS → cookie set → redirect to /) is completely unchanged\n6. No new dependencies added\n7. TypeScript compiles without errors: npx tsc --noEmit passes (or next build succeeds)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T18:04:23.910121958+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:06:18.748960162+06:00","closed_at":"2026-02-17T18:06:18.748960162+06:00","close_reason":"1f18629 Handle OAuth error params in callback route and show client-side toast","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-jsu.1","depends_on_id":"hypercerts-jsu","type":"parent-child","created_at":"2026-02-17T18:04:23.911881812+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-jw5","title":"Epic: Remove all SDS references and organization features","description":"Remove all Shared Data Server (SDS) infrastructure and organization-related features from the codebase. This includes environment configuration, type definitions, organization pages/components/queries, profile switching, and all related documentation. The application will only support PDS (Personal Data Server) going forward.","status":"closed","priority":1,"issue_type":"epic","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:19.625374856+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:08:54.570180551+06:00","closed_at":"2026-02-13T11:08:54.570180551+06:00","close_reason":"Completed: All SDS references and organization features removed"}
{"id":"hypercerts-jw5.1","title":"Remove SDS from environment configuration","description":"Remove NEXT_PUBLIC_SDS_URL environment variable from .env.example and .env.local. Remove sdsUrl field and validation from lib/config.ts (lines 194, 210, 236). Files affected: .env.example (lines 52-53), .env.local (line 20), lib/config.ts (lines 194, 210, 236).","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:25.0772292+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:01:21.906727001+06:00","closed_at":"2026-02-13T11:01:21.906727001+06:00","close_reason":"Completed: 970322f3161f84168f0130778997293b3c3cc853","dependencies":[{"issue_id":"hypercerts-jw5.1","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:57:25.078964487+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.10","title":"Remove profile switching dialog","description":"Delete components/profile-switch-dialog.tsx entirely. Remove this component from any layouts or pages that import it (likely in app/layout.tsx or similar). Remove the SignedInProvider usage from providers/SignedInProvider.tsx (line 27) that fetches organization data with getAuthenticatedRepo('sds'). This task depends on hypercerts-jw5.3 (session management) because the provider uses serverOverride.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:58:14.830834235+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:06:47.965297704+06:00","closed_at":"2026-02-13T11:06:47.965297704+06:00","close_reason":"Completed: af38f1b","dependencies":[{"issue_id":"hypercerts-jw5.10","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:58:14.832712721+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.10","depends_on_id":"hypercerts-jw5.3","type":"blocks","created_at":"2026-02-13T10:58:36.962725875+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.11","title":"Update repo context to handle PDS only","description":"Simplify lib/repo-context.ts to only handle PDS. Remove the server determination logic at line 61 (targetDid === userDid ? 'pds' : 'sds'). Remove RepoServer type field from interfaces if no longer needed. This task depends on hypercerts-jw5.2 (type definitions) and hypercerts-jw5.3 (session management) because we need the core types and session logic updated first.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:58:20.278269871+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:06:32.355814639+06:00","closed_at":"2026-02-13T11:06:32.355814639+06:00","close_reason":"Completed: 024d9b8b1dfe9cd5b49a45aeb7cae96cc95e2667","dependencies":[{"issue_id":"hypercerts-jw5.11","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:58:20.279708313+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.11","depends_on_id":"hypercerts-jw5.2","type":"blocks","created_at":"2026-02-13T10:58:37.013357307+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.11","depends_on_id":"hypercerts-jw5.3","type":"blocks","created_at":"2026-02-13T10:58:37.06325177+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.12","title":"Clean up organization query keys","description":"Remove organization-related query key definitions from lib/api/query-keys.ts (lines 41-48). This task depends on hypercerts-jw5.7 (delete organization queries) because we need to ensure no queries are using these keys before removing them.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:58:24.864366819+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:05:14.468657802+06:00","closed_at":"2026-02-13T11:05:14.468657802+06:00","close_reason":"Completed: 2e96aef","dependencies":[{"issue_id":"hypercerts-jw5.12","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:58:24.866971645+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.12","depends_on_id":"hypercerts-jw5.7","type":"blocks","created_at":"2026-02-13T10:58:37.11335342+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.13","title":"Update README to remove SDS documentation","description":"Remove all SDS references from README.md: line 10 (PDS/SDS account mention), line 45 (environment variable table entry), line 63 (test server URL example), lines 119-127 (architecture diagram and PDS vs SDS explanation), line 196 (organizations on SDS mention), line 254 (link to SDS GitHub repo). Update documentation to reflect PDS-only architecture. This task depends on all previous tasks (hypercerts-jw5.1 through hypercerts-jw5.12) because documentation should be updated last after all code changes are complete.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:58:31.437345428+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:08:36.620756909+06:00","closed_at":"2026-02-13T11:08:36.620756909+06:00","close_reason":"Completed: README already updated by previous commits","dependencies":[{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:58:31.438988373+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.1","type":"blocks","created_at":"2026-02-13T10:58:42.980883411+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.2","type":"blocks","created_at":"2026-02-13T10:58:43.031383969+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.3","type":"blocks","created_at":"2026-02-13T10:58:43.083619404+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.4","type":"blocks","created_at":"2026-02-13T10:58:43.135155641+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.5","type":"blocks","created_at":"2026-02-13T10:58:43.197015061+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.6","type":"blocks","created_at":"2026-02-13T10:58:43.246763992+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.7","type":"blocks","created_at":"2026-02-13T10:58:43.295935142+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.8","type":"blocks","created_at":"2026-02-13T10:58:43.345300956+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.9","type":"blocks","created_at":"2026-02-13T10:58:43.395508806+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.10","type":"blocks","created_at":"2026-02-13T10:58:43.443782516+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.11","type":"blocks","created_at":"2026-02-13T10:58:43.492942164+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.13","depends_on_id":"hypercerts-jw5.12","type":"blocks","created_at":"2026-02-13T10:58:43.545747096+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.2","title":"Update type definitions to remove SDS","description":"Change RepoServer type from 'pds' | 'sds' to just 'pds' in lib/repo-context.ts (line 8). Remove serverOverride parameter type that includes 'sds' from lib/atproto-session.ts (line 8). Update all type usage to reflect PDS-only infrastructure. Files affected: lib/repo-context.ts (lines 8, 23, 30, 61), lib/atproto-session.ts (lines 8, 19).","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:31.387671487+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:01:52.916414734+06:00","closed_at":"2026-02-13T11:01:52.916414734+06:00","close_reason":"Completed: 7cb57ff4f0e9545e9fd8b27d194de5236d269061","dependencies":[{"issue_id":"hypercerts-jw5.2","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:57:31.390035933+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.3","title":"Simplify session management by removing SDS logic","description":"Remove serverOverride parameter from getAuthenticatedRepo function in lib/atproto-session.ts (line 8). Remove server determination logic that defaults organizations to SDS (lines 19-26). Simplify to always use PDS. Remove comment about SDS default for organizations (line 23). This task depends on hypercerts-jw5.2 (type definition updates) because we need the types updated first.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:36.812241339+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:03:28.27736993+06:00","closed_at":"2026-02-13T11:03:28.27736993+06:00","close_reason":"Completed: f904aed717e18e851fcd2d6e590836fa9b7dc689","dependencies":[{"issue_id":"hypercerts-jw5.3","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:57:36.814164408+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.3","depends_on_id":"hypercerts-jw5.2","type":"blocks","created_at":"2026-02-13T10:58:36.651339481+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.4","title":"Update SDK initialization to remove SDS","description":"Remove 'sds: config.sdsUrl' from SDK server configuration in lib/hypercerts-sdk.ts (line 39). Update SDK initialization to only use PDS. This task depends on hypercerts-jw5.1 (environment config removal) because we need config.sdsUrl removed first.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:41.609155705+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:03:51.936722151+06:00","closed_at":"2026-02-13T11:03:51.936722151+06:00","close_reason":"Completed: 0ee8d8c967f42b720a0203022ce99e33647cb12a","dependencies":[{"issue_id":"hypercerts-jw5.4","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:57:41.611008192+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.4","depends_on_id":"hypercerts-jw5.1","type":"blocks","created_at":"2026-02-13T10:58:36.701434689+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.5","title":"Delete organization pages","description":"Delete the entire app/organizations/ directory, which includes: page.tsx (organization list), [orgDid]/page.tsx (organization detail), create/page.tsx (create organization), create/layout.tsx, loading.tsx, and [orgDid]/loading.tsx. This task depends on hypercerts-jw5.3 (session management simplification) because those files use the serverOverride parameter that will be removed.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:46.81007388+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:04:11.172066695+06:00","closed_at":"2026-02-13T11:04:11.172066695+06:00","close_reason":"Completed: 3428fe02f55fe17c9193be3d78e01b24903474a5","dependencies":[{"issue_id":"hypercerts-jw5.5","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:57:46.811920897+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.5","depends_on_id":"hypercerts-jw5.3","type":"blocks","created_at":"2026-02-13T10:58:36.75669208+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.6","title":"Delete organization components","description":"Delete organization-related components: components/organization-form.tsx, components/organization-detail-view.tsx, components/organization-creation-success.tsx, components/collaborators-list-view.tsx, components/add-contributors-form.tsx. Remove any imports of these components from other files. This task can run in parallel with hypercerts-jw5.5 (delete pages) since they are independent.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:52.089516982+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:02:17.815171991+06:00","closed_at":"2026-02-13T11:02:17.815171991+06:00","close_reason":"Completed: 4299fe74ca5d3a6bc7dcd16db4478e21495c7e5c","dependencies":[{"issue_id":"hypercerts-jw5.6","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:57:52.091170987+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.7","title":"Delete organization queries","description":"Delete the entire queries/organizations/ directory, which includes use-check-handle-query.ts and index.ts. Also remove checkHandleAvailability function from lib/api/external/bluesky.ts (lines 42-60) that checks handle availability on SDS server. This task can run in parallel with hypercerts-jw5.5 and hypercerts-jw5.6.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:57:57.491629768+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:02:44.401504275+06:00","closed_at":"2026-02-13T11:02:44.401504275+06:00","close_reason":"Completed: f20bf2f4eb234d67c9e06a9b71b103be938c90f9","dependencies":[{"issue_id":"hypercerts-jw5.7","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:57:57.493747823+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.8","title":"Remove organization operations from create-actions","description":"Remove organization-related functions from lib/create-actions.ts: lines 202 (create org with serverOverride), 214 (add collaborators), 232 (remove collaborators), 246 (list organizations). This task depends on hypercerts-jw5.3 (session management) because these functions use serverOverride parameter.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:58:02.724974343+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:07:24.646163697+06:00","closed_at":"2026-02-13T11:07:24.646163697+06:00","close_reason":"Completed: 8b6439f","dependencies":[{"issue_id":"hypercerts-jw5.8","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:58:02.726703099+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.8","depends_on_id":"hypercerts-jw5.3","type":"blocks","created_at":"2026-02-13T10:58:36.812943121+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-jw5.9","title":"Simplify blob utilities to remove SDS URL handling","description":"Remove SDS URL handling from lib/blob-utils.ts (line 25) - simplify blob URL resolution to only use PDS. Remove SDS URL usage from app/hypercerts/[hypercertUri]/page.tsx (line 86) for image blob resolution. This task depends on hypercerts-jw5.1 (environment config) and hypercerts-jw5.5 (delete org pages) because we need config cleaned up and no org pages referencing blobs.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T10:58:09.274201803+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:07:42.730303409+06:00","closed_at":"2026-02-13T11:07:42.730303409+06:00","close_reason":"Completed: Already cleaned up in previous commits","dependencies":[{"issue_id":"hypercerts-jw5.9","depends_on_id":"hypercerts-jw5","type":"parent-child","created_at":"2026-02-13T10:58:09.276322082+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.9","depends_on_id":"hypercerts-jw5.1","type":"blocks","created_at":"2026-02-13T10:58:36.863175646+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-jw5.9","depends_on_id":"hypercerts-jw5.5","type":"blocks","created_at":"2026-02-13T10:58:36.913677646+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-la0","title":"Fix: AuthErrorToast missing Suspense boundary (from hypercerts-jsu.1)","description":"Review of hypercerts-jsu.1 found: AuthErrorToast uses useSearchParams() without a wrapping \u003cSuspense\u003e boundary. Next.js App Router requires Suspense around any component using useSearchParams() to avoid opting the entire page out of static rendering. See: https://nextjs.org/docs/app/api-reference/functions/use-search-params#static-rendering. Evidence: providers/AuthErrorToast.tsx uses useSearchParams() at line 10; providers/SignedInProvider.tsx renders \u003cAuthErrorToast /\u003e at line 37 with no Suspense wrapper. Fix: wrap \u003cAuthErrorToast /\u003e in \u003cSuspense fallback={null}\u003e in SignedInProvider.tsx. All routes are currently dynamic so this does not cause a runtime failure today, but it is a correctness violation that will break if any route becomes static.","acceptance_criteria":"1. AuthErrorToast is wrapped in \u003cSuspense fallback={null}\u003e in SignedInProvider.tsx\n2. No other changes to AuthErrorToast.tsx or the callback route\n3. TypeScript compiles: npx tsc --noEmit passes\n4. The toast still works correctly (auth_error in URL → toast shown → URL cleaned)","status":"closed","priority":2,"issue_type":"bug","assignee":"karma.gainforest.id","owner":"kzoepa@gmail.com","estimated_minutes":10,"created_at":"2026-02-17T18:26:35.114159758+06:00","created_by":"kzoeps","updated_at":"2026-02-17T18:29:38.595674259+06:00","closed_at":"2026-02-17T18:29:38.595674259+06:00","close_reason":"cdb3096 fix: wrap AuthErrorToast in Suspense boundary","dependencies":[{"issue_id":"hypercerts-la0","depends_on_id":"hypercerts-jsu.1","type":"discovered-from","created_at":"2026-02-17T18:26:38.850583224+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-mt9","title":"Fix: Authenticate page H1 text invisible (white on light background) from hypercerts-nyk.10","description":"Review of hypercerts-nyk.10 found: The commit changed 'main.flex.flex-col.items-center \u003e h1.text-primary' color to #ffffff (white). This selector targets the Authenticate page, which has a light background (#fafafa). The H1 'Authenticate' text is now white on a light background — invisible to users. The spec intended to make text white only for the dark left panel on the sign-in page, but the selector used targets a different page entirely. Fix: either (a) remove the color override for this selector (the scoped .md:\\\\:bg-slate-100 .text-primary rule at line ~300 already handles the sign-in left panel), or (b) add a dark background to the Authenticate page main element. Evidence: git show 7669337 -- lib/atproto-branding.ts shows the change at line ~209-210. The Authenticate page background is #fafafa (line ~274, 282, 289 of atproto-branding.ts). File to fix: lib/atproto-branding.ts in branch karma/hyper-83-use-the-certified-branding-in-the-scaffold-app.","status":"open","priority":2,"issue_type":"bug","owner":"kzoepa@gmail.com","created_at":"2026-02-17T17:00:46.818177053+06:00","created_by":"kzoeps","updated_at":"2026-02-17T17:00:46.818177053+06:00","dependencies":[{"issue_id":"hypercerts-mt9","depends_on_id":"hypercerts-nyk.10","type":"discovered-from","created_at":"2026-02-17T17:00:50.990751787+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-nyk","title":"Epic: Add ATProto OAuth CSS branding to scaffold","description":"Port the custom OAuth branding implementation from maearth-app to hypercerts-scaffold. The scaffold uses the same PDS (certified.app) but currently serves bare client metadata with no branding. Goal: when users authenticate via the scaffold in production mode, the PDS OAuth pages show custom branding (logo, colors, 'Sign in with Certified' imagery) instead of default Hypercerts styling. The PDS itself stays neutral — each app injects its own branding via CSS in client metadata. Loopback mode cannot support branding (ATProto spec limitation) so branding only applies in production. Scope: create branding CSS module, update metadata endpoint, add placeholder assets. Out of scope: changing token_endpoint_auth_method, modifying the PDS itself.","status":"open","priority":2,"issue_type":"epic","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","created_at":"2026-02-16T12:29:31.349871338+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:57:58.566194364+06:00","labels":["needs-integration-review","scope:medium"]}
{"id":"hypercerts-nyk.1","title":"Create sanitizeUrlForCss utility function","description":"## Files\n- lib/atproto-branding.ts (create)\n\n## What to do\nCreate a new file `lib/atproto-branding.ts`. For now, only add the `sanitizeUrlForCss` function — the CSS generation function will be added in a later task.\n\nCopy the `sanitizeUrlForCss` function from the reference implementation at `maearth-app/src/lib/atproto-branding.ts` (lines 20-45). This function:\n\n1. Takes a URL string as input\n2. Validates it is a proper URL via `new URL()`\n3. Rejects non-http/https protocols\n4. Escapes dangerous CSS characters: backslash, single quote, double quote, closing paren, newlines, carriage returns\n5. Returns the sanitized href string\n\nExport the function (it will be used by `generateBrandingCss` in the next task).\n\n## Dont\n- Do not add the `generateBrandingCss` function yet (separate task)\n- Do not add any CSS strings\n- Do not modify any other files","acceptance_criteria":"1. lib/atproto-branding.ts exists and exports sanitizeUrlForCss\n2. Function throws on invalid URLs (not parseable by new URL())\n3. Function throws on non-http/https protocols (e.g. javascript:, data:)\n4. Function escapes: backslash, single quote, double quote, closing paren, newline, carriage return\n5. Function returns the sanitized URL href for valid http/https URLs\n6. TypeScript compiles without errors","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-16T12:29:44.660638545+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-16T12:36:02.551717428+06:00","closed_at":"2026-02-16T12:36:02.551717428+06:00","close_reason":"9e6630a Create sanitizeUrlForCss utility function","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-nyk.1","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-16T12:29:44.661946519+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.10","title":"Change PDS sign-in left panel background to dark navy (#0F2544) and adjust text contrast","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## What to do\nThe PDS OAuth sign-in page has a two-panel layout on desktop. The left panel contains the H1 heading (logo/branding area) and is currently styled with a light gray background (`#f0f0f3`). Change it to dark navy `#0F2544`.\n\n### 1. Left panel background (line ~270-274)\n```css\n/* Left panel styling */\n.md\\\\:bg-slate-100,\n.dark .md\\\\:bg-slate-100,\n.md\\\\:dark\\\\:bg-slate-800 {\n  background-color: #f0f0f3 !important;  /* CHANGE to #0F2544 */\n}\n```\n\n### 2. Text contrast in the left panel\nSince the background is now dark, any text rendered in the left panel needs to be light. The H1 text color is currently `#2b2d31` (dark). Update:\n\n- Line ~137: `.grid h1.text-primary::after` color → `#ffffff` (or remove if task .8 replaces this with an image — but set it to white as a fallback)\n- Line ~203: `main.flex.flex-col.items-center \u003e h1.text-primary` color → `#ffffff`\n\nAlso check the `.text-primary` override at line ~317-318:\n```css\n.text-primary {\n  color: #757780 !important;\n}\n```\nThis is a global override that affects text across ALL pages (sign-in, authorize, error). Since only the left panel is dark, scope the light text to the left panel only. Add a new rule:\n```css\n/* Light text for dark left panel */\n.md\\\\:bg-slate-100 .text-primary,\n.md\\\\:bg-slate-100 h1.text-primary {\n  color: #ffffff !important;\n}\n```\n\n### 3. Mobile background\nOn mobile the layout is single-column. The left panel content stacks on top. Check the mobile section (line ~690-727) — the `main` background is `#f8f8fa`. The mobile grid content container (`.grid.grow.content-center`) should also get the dark navy background:\n```css\n@media (max-width: 767px) {\n  .grid.grow.content-center {\n    background-color: #0F2544 !important;\n    padding: 24px !important;\n    border-radius: 12px !important;\n  }\n}\n```\n\n## Don't\n- Change the right panel background (form area) — it stays light\n- Change button colors or form input styling\n- Modify the authorize page or error page backgrounds\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. The left panel background on the PDS sign-in page is #0F2544 (dark navy)\n2. Text in the left panel (H1, any .text-primary elements) is white (#ffffff) for contrast\n3. The right panel (form area) background remains light (#fafafa)\n4. The global .text-primary color (#757780) is NOT changed — only scoped overrides for the dark panel\n5. Mobile layout has appropriate dark background for the heading area\n6. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"kzoeps","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T16:46:49.635564674+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:56:36.625245941+06:00","closed_at":"2026-02-17T16:56:36.625245941+06:00","close_reason":"7669337 Change PDS sign-in left panel background to dark navy and adjust text contrast","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.10","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T16:46:49.637638507+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.11","title":"Fix dark-on-dark text contrast in PDS sign-in dark panel","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## Context\nThe PDS sign-in page left panel background was changed to dark navy (`#0F2544`) in task .10. There is a small subtitle/label text right underneath the H1 heading (e.g. 'Enter your password' or 'Enter your identifier'). This text uses the class `text-slate-600` which the branding CSS globally overrides to `#4a4b53` (dark gray) at line ~327-334. On the dark navy panel, this dark text is invisible.\n\nThe form fields, inputs, and buttons in the right panel are fine — this is ONLY about the subtitle text in the dark left panel.\n\n## What to do\nAdd a scoped CSS override for the subtitle text inside the dark left panel container. The left panel container is `.md\\\\:bg-slate-100` on desktop.\n\nAdd this rule right after the existing scoped text override block (after line ~303):\n\n```css\n/* Subtitle text in dark left panel (e.g. 'Enter your password') */\n.md\\\\:bg-slate-100 .text-slate-600,\n.md\\\\:bg-slate-100 .text-slate-700,\n.md\\\\:bg-slate-100 .text-slate-400,\n.md\\\\:bg-slate-100 p {\n  color: rgba(255, 255, 255, 0.7) !important;\n}\n```\n\nUse `rgba(255, 255, 255, 0.7)` (70% white) so it reads as a muted subtitle, not as prominent as the H1 heading which is full `#ffffff`.\n\nAlso add the mobile equivalent inside the existing `@media (max-width: 767px)` block, scoped to `.grid.grow.content-center`:\n\n```css\n.grid.grow.content-center .text-slate-600,\n.grid.grow.content-center .text-slate-700,\n.grid.grow.content-center .text-slate-400,\n.grid.grow.content-center p {\n  color: rgba(255, 255, 255, 0.7) !important;\n}\n```\n\n## Don't\n- Change any global text color rules (lines ~319-334 must stay as-is)\n- Change the right panel (form area) styling\n- Change button colors or form input colors\n- Modify the dark panel background color (`#0F2544`)\n- Add overrides for form elements, inputs, or anything in the right panel\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. The subtitle text (e.g. 'Enter your password') below the H1 in the dark left panel is legible — light colored (rgba white ~70%)\n2. The H1 heading itself remains full white (#ffffff)\n3. The right panel form area text colors remain dark (unchanged)\n4. Global text color rules at lines ~319-334 are NOT modified\n5. Mobile layout subtitle text in the dark heading area is also light\n6. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":1,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":45,"created_at":"2026-02-17T18:04:19.192441679+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:19:30.219680222+06:00","closed_at":"2026-02-17T18:19:30.219680222+06:00","close_reason":"02247ea fix dark-on-dark subtitle text contrast in PDS sign-in dark panel","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.11","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T18:04:19.193991709+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.12","title":"Replace certified-logo.svg with hypercerts_logo_horizontal.svg for the logo above H1 heading in PDS branding CSS","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## Context\nThe logo displayed above the H1 heading on the PDS sign-in page currently uses `certified-logo.svg` (the small C checkmark icon). It should instead use `hypercerts_logo_horizontal.svg` — the full horizontal Hypercerts wordmark with badge icon (1929x340px, black fill).\n\nNote: `certified-logo.svg` is STILL correct for the submit button icon (the small C next to 'Sign in with Certified' text). This task ONLY changes the large logo displayed above the heading.\n\n## What to do\n\n### 1. Add a new URL variable for the horizontal logo\nAt the top of `generateBrandingCss()`, alongside the existing `logoUrl` and `signinUrl`, add:\n```typescript\nconst horizontalLogoUrl = \\`\\${baseUrl}/hypercerts_logo_horizontal.svg\\`;\nconst sanitizedHorizontalLogoUrl = sanitizeUrlForCss(horizontalLogoUrl);\n```\n\n### 2. Update the logo replacement section (lines ~85-109)\nChange `background-image: url('${sanitizedLogoUrl}')` to `background-image: url('${sanitizedHorizontalLogoUrl}')`.\n\nSince the horizontal logo is wide (1929:340 ≈ 5.67:1 aspect ratio), revert the container dimensions back to wide rectangles:\n- Desktop: `width: 200px; height: 40px` (was 54x54)\n- Mobile: `width: 150px; height: 30px` (was 40x40)\n\n### 3. Update the Authenticate page logo (lines ~187-206)\nChange `background-image: url('${sanitizedLogoUrl}')` to `background-image: url('${sanitizedHorizontalLogoUrl}')`.\n- Desktop: `width: 200px; height: 40px` (was 54x54 from task .7)\n- Mobile: `width: 150px; height: 30px` (was 42x42)\n\n### 4. SVG visibility on dark background\nThe SVG has `fill: #000` (black). On the dark navy panel (`#0F2544`), black is invisible. Apply a CSS filter to invert the logo to white:\n```css\nimg[alt=\"Hypercerts Logo\"],\nimg[alt*=\"Logo\"] {\n  /* ... existing styles ... */\n  filter: invert(1) !important;\n}\n```\nFor the `::before` pseudo-element on the Authenticate page, also add `filter: invert(1)`.\n\n### 5. Do NOT change the button logo\nThe `sanitizedLogoUrl` (`certified-logo.svg`) is still used for the submit button `::before` icon at lines ~635-644. Leave that unchanged.\n\n## Don't\n- Change the submit button logo (keep `certified-logo.svg` for buttons)\n- Change the `certified-signin.svg` H1 image replacement\n- Modify the `logoUrl` variable itself — add a NEW `horizontalLogoUrl` variable\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. The logo above the H1 heading uses `hypercerts_logo_horizontal.svg` (not `certified-logo.svg`)\n2. The submit button icon still uses `certified-logo.svg` (the small C)\n3. The horizontal logo is visible (white/light) on the dark navy panel — uses CSS filter or equivalent\n4. Logo container dimensions match the wide aspect ratio (~5.67:1) of the horizontal SVG\n5. Both desktop and mobile logo sizes are appropriate\n6. The Authenticate page logo also uses the horizontal logo\n7. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T18:06:56.176917231+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:20:09.712838205+06:00","closed_at":"2026-02-17T18:20:09.712838205+06:00","close_reason":"43a6bab use hypercerts_logo_horizontal.svg for logo above H1 heading","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.12","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T18:06:56.179266145+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.13","title":"Retheme PDS branding CSS to flow with PDS design system instead of fighting it","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## Context\nThe current branding CSS forces `color-scheme: light only` and overrides nearly every color class with hardcoded values and `!important`. This fights the PDS's own design system and causes issues like dark-on-dark text when we set the left panel to a dark color.\n\nThe PDS layout uses hardcoded Tailwind `slate-*` classes (NOT the `--color-contrast-*` scale) for the sign-in page. The left panel is `md:bg-slate-100` (`#f1f5f9`), the right panel inherits `bg-white`. The `--branding-color-primary` variable controls `text-primary` (H1 title), `bg-primary` (buttons), and the contrast scale hue for nav/footer/cards.\n\n## What to do\nRefactor `generateBrandingCss()` to work WITH the PDS instead of against it. The goal: set the right CSS variables so the PDS derives a navy-blue-tinted theme naturally, then only add targeted overrides for things the PDS can't do on its own.\n\n### 1. Set branding CSS variables to navy theme\nReplace the current `:root` block (lines ~68-83) with:\n```css\n:root {\n  --branding-color-primary: 15 37 68;\n  --branding-color-primary-contrast: 255 255 255;\n  --branding-color-primary-hue: 216;\n  --branding-color-error: 229 72 77;\n  --branding-color-error-contrast: 255 255 255;\n  --branding-color-error-hue: 358;\n  --branding-color-warning: 245 159 0;\n  --branding-color-warning-contrast: 43 45 49;\n  --branding-color-warning-hue: 38;\n  --branding-color-success: 43 138 62;\n  --branding-color-success-contrast: 255 255 255;\n  --branding-color-success-hue: 134;\n}\n```\nThis makes:\n- `text-primary` / `bg-primary` = dark navy (`#0F2544`)\n- `text-primary-contrast` = white\n- The contrast scale gets a subtle navy-blue tint (hue 216)\n- Buttons become navy instead of charcoal\n\n### 2. Remove `color-scheme: light only !important`\nDelete the `color-scheme` forcing. Let the PDS respect the user's system preference or its own defaults.\n\n### 3. Left panel dark override (KEEP)\nKeep the `md:bg-slate-100` override to `#0F2544` — this is necessary because the PDS hardcodes `slate-100` for the left panel.\n\n### 4. Left panel text overrides (KEEP)\nKeep the scoped white text rules for `.md\\\\:bg-slate-100` — these are necessary for the dark panel.\n\n### 5. REMOVE most global color overrides\nDelete the following sections that fight the PDS's native styling:\n- `/* FORCE LIGHT COLOR SCHEME */` — remove `color-scheme` forcing\n- `/* MAIN BACKGROUNDS */` — remove body, `.bg-white`, `.dark .bg-white` overrides. Let the PDS handle these.\n- `/* TEXT COLORS - LIGHT THEME */` — remove `.text-slate-900`, `.text-slate-600`, etc. overrides. The PDS's own Tailwind slate colors are fine.\n- `/* ACCENT/PRIMARY COLORS */` — remove `.text-primary`, `.bg-primary`, `.border-primary` overrides. These now come from the CSS variables.\n- `/* FORM INPUTS */` — remove input/textarea/select overrides. Let PDS style them.\n- `/* USERNAME PREVIEW \u0026 PASSWORD STRENGTH */` — remove `.bg-gray-200`, `.bg-gray-300`, text-gray-* overrides.\n- `/* ACCOUNT SELECTION \u0026 FORM ITEMS */` — remove `.bg-gray-100` overrides.\n- `/* CHECKBOXES */` — remove. PDS handles these via `accent-color` from primary.\n- `/* INFO/WARNING/ERROR BOXES */` — remove `.bg-contrast-*` overrides. The contrast scale now has the right hue.\n- `/* BUTTONS */` — remove the generic button color overrides (`.bg-primary`, hover states). Keep ONLY the button text/icon replacement rules (the `::before` and `::after` for 'Sign in with Certified').\n- `/* LINKS */` — remove. Let PDS handle link colors.\n- `/* FORM TEXT ELEMENTS */` — remove.\n- `/* DROPDOWN/SELECT */` — remove.\n- `/* ERROR PAGE */` — remove `.text-4xl`, `.text-5xl` overrides.\n- `/* Input container */` overrides — remove all the `.rounded-lg` input container styling.\n- `/* Text that should be dark on light backgrounds */` — remove the `.text-white` override (line ~444) which forces `.text-white` to dark. This was needed when forcing light mode but is harmful now.\n\n### 6. KEEP these sections\n- Logo replacement (`img[alt=\"Hypercerts Logo\"]`) — PDS can't do this natively\n- H1 text replacement with `certified-signin.svg` — PDS can't do this\n- Button text/icon replacement (`::before`/`::after`) — PDS can't do this\n- Left panel dark background + scoped light text\n- Mobile dark heading area\n- Authenticate page logo and button replacements\n- Error page logo suppression\n- Desktop/mobile alignment rules\n\n### 7. Secondary button overrides for the submit button\nThe submit button `button[type=\"submit\"]` styling can be simplified. Since `bg-primary` now resolves to navy via the CSS variable, the button will naturally be navy. Keep only the text/icon replacement (`font-size: 0`, `::before`, `::after`).\n\n### 8. Right panel lighter shade\nThe right panel (`bg-white`) will stay white by default. If you want it to be a lighter shade of navy instead of pure white, add:\n```css\n.bg-white,\n.dark .bg-white {\n  background-color: hsl(216 20% 97%) !important;\n}\n```\nThis gives a very subtle navy-tinted off-white that flows with the left panel. But this is optional — pure white also works.\n\n## Don't\n- Remove the logo/image replacement CSS\n- Remove the button text replacement CSS\n- Remove the left panel dark background override\n- Change the SVG asset URLs\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. The `:root` block sets `--branding-color-primary: 15 37 68` and `--branding-color-primary-hue: 216`\n2. No `color-scheme: light only` forcing remains\n3. The left panel is still dark navy (`#0F2544`) with white text\n4. The right panel uses the PDS's native light styling (no hardcoded overrides)\n5. Buttons are navy (derived from primary variable) with the C logo + 'Sign in with Certified' text\n6. The H1 still shows `certified-signin.svg` image\n7. The horizontal logo still shows above the H1 with `filter: invert(1)`\n8. Form inputs, text, links on the right panel look correct (PDS native styling)\n9. The generated CSS is significantly shorter than before (most global overrides removed)\n10. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":60,"created_at":"2026-02-17T18:53:05.142415492+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:58:49.42997752+06:00","closed_at":"2026-02-17T18:58:49.42997752+06:00","close_reason":"ce6a9cf refactor: retheme PDS branding CSS to flow with PDS design system","labels":["scope:medium"],"dependencies":[{"issue_id":"hypercerts-nyk.13","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T18:53:05.145413066+06:00","created_by":"karma.gainforest.id"},{"issue_id":"hypercerts-nyk.13","depends_on_id":"hypercerts-nyk.14","type":"blocks","created_at":"2026-02-17T18:53:28.893634687+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.14","title":"Align horizontal logo to the left in PDS branding CSS","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## What to do\nThe horizontal Hypercerts logo above the H1 heading is currently right-aligned on desktop. It should be left-aligned to match the `certified-signin.svg` heading image alignment.\n\n### 1. Desktop logo alignment (line ~96)\nChange `background-position: right center` to `background-position: left center`:\n```css\nimg[alt=\"Hypercerts Logo\"],\nimg[alt*=\"Logo\"] {\n  /* ... */\n  background-position: left center !important;  /* was: right center */\n}\n```\n\n### 2. Desktop alignment section (line ~780-782)\nThe desktop alignment section forces `.grid.grow.content-center` to `justify-items: end`. Change to `justify-items: start`:\n```css\n@media (min-width: 768px) {\n  .grid.grow.content-center {\n    justify-items: start !important;  /* was: end */\n  }\n}\n```\n\n### 3. H1 image alignment (line ~146)\nThe `certified-signin.svg` background-position is `right center`. Change to `left center`:\n```css\n.grid h1.text-primary::after {\n  /* ... */\n  background-position: left center !important;  /* was: right center */\n}\n```\n\n### 4. Desktop text alignment (line ~785-787)\nChange `.md\\\\:text-right` override from `text-align: right` to `text-align: left`:\n```css\n.md\\\\:text-right {\n  text-align: left !important;  /* was: right */\n}\n```\n\n## Don't\n- Change mobile alignment (mobile is already left-aligned)\n- Change the Authenticate page logo alignment (that's centered, which is correct)\n- Change any colors or dimensions\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. The horizontal logo above the H1 is left-aligned on desktop\n2. The certified-signin.svg H1 image is left-aligned on desktop\n3. Mobile alignment remains left-aligned (unchanged)\n4. Authenticate page logo remains centered (unchanged)\n5. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-17T18:53:22.281135938+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:56:21.811918955+06:00","closed_at":"2026-02-17T18:56:21.811918955+06:00","close_reason":"9a98af1 align horizontal logo and H1 to left on desktop","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-nyk.14","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T18:53:22.283093746+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.15","title":"Remove forced dark left panel — let PDS derive panel colors naturally for both light and dark mode","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## Context\nThe branding CSS currently forces the left panel to dark navy (`#0F2544`) in ALL modes. This works great in dark mode but clashes in light mode. We want:\n\n- **Light mode**: PDS native light panel. Buttons stay dark navy. Light variant of certified-signin SVG.\n- **Dark mode**: Dark navy (`#0F2544`) panel (our brand color). Buttons need to pop (brighter blue). Dark variant of certified-signin SVG (existing).\n\nTwo SVG variants are now available:\n- `/public/certified-signin.svg` — white text, for dark backgrounds\n- `/public/certified-signin-light.svg` — dark navy text (`#0F2544`), for light backgrounds\n\n## What to do\n\n### 1. Scope the left panel dark override to dark mode ONLY\nReplace the current unconditional override (lines ~183-189):\n```css\n/* REPLACE THIS */\n.md\\\\:bg-slate-100,\n.dark .md\\\\:bg-slate-100,\n.md\\\\:dark\\\\:bg-slate-800 {\n  background-color: #0F2544 !important;\n}\n```\nWith a dark-mode-only override:\n```css\n@media (prefers-color-scheme: dark) {\n  .md\\\\:bg-slate-100,\n  .md\\\\:dark\\\\:bg-slate-800 {\n    background-color: #0F2544 !important;\n  }\n}\n```\nIn light mode, the PDS native `slate-100` (`#f1f5f9`) takes over.\n\n### 2. Scope white text overrides to dark mode ONLY\nMove the existing scoped text overrides (lines ~191-203) inside a `@media (prefers-color-scheme: dark)` block:\n```css\n@media (prefers-color-scheme: dark) {\n  .md\\\\:bg-slate-100 .text-primary,\n  .md\\\\:bg-slate-100 h1.text-primary {\n    color: #ffffff !important;\n  }\n  .md\\\\:bg-slate-100 .text-slate-600,\n  .md\\\\:bg-slate-100 .text-slate-700,\n  .md\\\\:bg-slate-100 .text-slate-400,\n  .md\\\\:bg-slate-100 p {\n    color: rgba(255, 255, 255, 0.7) !important;\n  }\n}\n```\n\n### 3. Make logo `filter: invert(1)` dark-mode only\nRemove `filter: invert(1)` from the base logo rules (lines ~100, ~223). Add inside a dark mode media query:\n```css\n@media (prefers-color-scheme: dark) {\n  img[alt=\"Hypercerts Logo\"],\n  img[alt*=\"Logo\"] {\n    filter: invert(1) !important;\n  }\n  main.flex.flex-col.items-center \u003e h1.text-primary::before {\n    filter: invert(1) !important;\n  }\n}\n```\n\n### 4. Use light/dark certified-signin SVG variants\nAdd a new URL variable:\n```typescript\nconst signinLightUrl = \\`\\${baseUrl}/certified-signin-light.svg\\`;\nconst sanitizedSigninLightUrl = sanitizeUrlForCss(signinLightUrl);\n```\n\nUse the light variant as the default H1 image (for light mode):\n```css\n.grid h1.text-primary::after {\n  background-image: url('${sanitizedSigninLightUrl}') !important;\n}\n```\n\nOverride with the dark variant in dark mode:\n```css\n@media (prefers-color-scheme: dark) {\n  .grid h1.text-primary::after {\n    background-image: url('${sanitizedSigninUrl}') !important;\n  }\n}\n```\n\n### 5. Dark mode button visibility\nButtons are `bg-primary` = `#0F2544` which blends into the dark background. Add a dark-mode override:\n```css\n@media (prefers-color-scheme: dark) {\n  button[type=\"submit\"].bg-primary,\n  button.bg-primary,\n  [role=\"button\"].bg-primary {\n    background-color: #3B82F6 !important;\n  }\n  button[type=\"submit\"].bg-primary:hover,\n  button.bg-primary:hover,\n  [role=\"button\"].bg-primary:hover {\n    background-color: #2563EB !important;\n  }\n}\n```\n\n### 6. Scope mobile dark heading to dark mode only\nMove the mobile dark background from unconditional to dark-mode-only:\n```css\n@media (prefers-color-scheme: dark) and (max-width: 767px) {\n  .grid.grow.content-center {\n    background-color: #0F2544 !important;\n    padding: 24px !important;\n    border-radius: 12px !important;\n  }\n  .grid.grow.content-center .text-slate-600,\n  .grid.grow.content-center .text-slate-700,\n  .grid.grow.content-center .text-slate-400,\n  .grid.grow.content-center p {\n    color: rgba(255, 255, 255, 0.7) !important;\n  }\n}\n```\nIn light mode mobile, remove the dark background/text overrides entirely.\n\n### 7. Authenticate page H1 color — dark mode only\nMove `color: #ffffff` to dark mode:\n```css\nmain.flex.flex-col.items-center \u003e h1.text-primary {\n  /* no color override — PDS handles it */\n  font-size: 1.5rem !important;\n  line-height: 2rem !important;\n}\n@media (prefers-color-scheme: dark) {\n  main.flex.flex-col.items-center \u003e h1.text-primary {\n    color: #ffffff !important;\n  }\n}\n```\n\n## Don't\n- Remove the logo/image replacement CSS structure\n- Remove the button text/icon replacement CSS (`::before`/`::after`)\n- Change the `:root` CSS variables\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. Light mode: left panel is PDS native light blue-gray (slate-100), NOT dark navy\n2. Dark mode: left panel is dark navy (#0F2544)\n3. Light mode: H1 shows certified-signin-light.svg (dark navy text on light bg)\n4. Dark mode: H1 shows certified-signin.svg (white text on dark bg)\n5. Light mode: logo is black (no filter), visible on light panel\n6. Dark mode: logo is white (filter: invert), visible on dark panel\n7. Light mode: buttons are dark navy (from primary variable)\n8. Dark mode: buttons are bright blue (#3B82F6) that pops against dark background\n9. Mobile heading area is only dark in dark mode\n10. Button text/icon replacement (::before/::after) works in both modes\n11. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T19:16:37.98413166+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:28:21.933392724+06:00","closed_at":"2026-02-17T19:28:21.933392724+06:00","close_reason":"5b1f9da scope left panel dark override and logo invert to dark mode only","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.15","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T19:16:37.985831116+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.16","title":"Clean up PDS branding CSS: fix broad selector, remove dead code, consolidate dark mode blocks","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## What to do\nAddress 6 CSS quality issues found during review. Bundle them into a single cleanup pass.\n\n### 1. Fix overly broad `img[alt*=\"Logo\"]` selector (P3 — hypercerts-5jk)\nThe substring match `alt*=\"Logo\"` could accidentally affect any image with 'Logo' in its alt text on PDS pages. Change to exact match only:\n```css\n/* BEFORE */\nimg[alt=\"Hypercerts Logo\"],\nimg[alt*=\"Logo\"] {\n\n/* AFTER */\nimg[alt=\"Hypercerts Logo\"] {\n```\nRemove the `img[alt*=\"Logo\"]` selector everywhere it appears (base rule, mobile rule, and the dark mode `filter: invert` rule). The exact `img[alt=\"Hypercerts Logo\"]` match is sufficient.\n\n### 2. Remove dead `color: #ffffff` on `::after` (P3 — hypercerts-jgh)\nThe `.grid h1.text-primary::after` has `color: #ffffff !important` but `content: \"\"` — no text to color. Remove the dead property:\n```css\n.grid h1.text-primary::after {\n  content: \"\" !important;\n  /* ... */\n  /* color: #ffffff !important;  \u003c-- DELETE */\n}\n```\n\n### 3. Consolidate dark mode blocks (P4 — hypercerts-c3t)\nThere are 5 scattered `@media (prefers-color-scheme: dark)` blocks throughout the file. Merge them into a single block at the end of the CSS (before the closing backtick). This makes dark mode behavior easy to find and maintain.\n\nThe consolidated block should contain ALL dark-mode-only rules:\n- Left panel background override (`#0F2544`)\n- Left panel white text overrides\n- Left panel subtitle text overrides\n- Logo `filter: invert(1)`\n- Authenticate page logo `filter: invert(1)`\n- Authenticate page H1 `color: #ffffff`\n- H1 `certified-signin.svg` (dark variant) override\n- Button bright blue override (`#3B82F6`)\n- Mobile dark heading (combined with `max-width: 767px`)\n\n### 4. Remove unnecessary `position: relative` (P4 — hypercerts-84k)\nThe `main.flex.flex-col.items-center \u003e h1.text-primary { position: relative !important; }` rule is unnecessary — the `::before` pseudo-element is block-flow, not absolutely positioned. Remove it.\n\n### 5. Remove redundant `width: 32px` override (P4 — hypercerts-ua9)\nThe `div.w-8` container is already 32px in Tailwind. The override `width: 32px !important` is a no-op. Also remove the dead `object-position: left center` on `img[alt=\"Ma Earth\"]` (32x32 square, object-position has no effect with `object-fit: contain`).\n\n### 6. Remove redundant mobile `background-position` (P4 — hypercerts-c7v)\nThe mobile override repeats `background-position: left center` which is already set in the base rule. Remove the redundant line from the mobile media query.\n\n## Don't\n- Change any functional behavior (colors, sizes, images, selectors that work correctly)\n- Change the `:root` CSS variables\n- Change SVG asset URLs\n- Reorder rules in a way that changes specificity/cascade behavior\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. No `img[alt*=\"Logo\"]` substring selector remains — only exact `img[alt=\"Hypercerts Logo\"]`\n2. No dead `color` property on empty `content: \"\"` pseudo-elements\n3. At most 2 `@media (prefers-color-scheme: dark)` blocks in the entire CSS (one for general dark mode, one combined with max-width for mobile)\n4. No `position: relative` on the Authenticate page H1\n5. No redundant `width: 32px` on `div.w-8` container\n6. No redundant `background-position` in mobile override\n7. All existing visual behavior is preserved (light mode and dark mode look identical before and after)\n8. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":45,"created_at":"2026-02-17T19:53:27.001182526+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:56:02.98746847+06:00","closed_at":"2026-02-17T19:56:02.98746847+06:00","close_reason":"0aeb7a0 Clean up PDS branding CSS: fix broad selector, remove dead code, consolidate dark mode blocks","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.16","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T19:53:27.003120929+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.17","title":"Remove Ma Earth leftovers and fix stale comments in branding CSS","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## What to do\nClean up leftover references from the Ma Earth app port and fix stale comments.\n\n### 1. Remove or fix Ma Earth selectors (lines ~115-127)\nThe `img[alt=\"Ma Earth\"]` selector is a leftover from the Ma Earth app. The Hypercerts PDS Authorize page uses a different alt text. Either:\n- If the Authorize page uses `img[alt=\"Hypercerts Logo\"]` (same as the sign-in page), then the existing logo replacement rule already covers it — DELETE the entire Ma Earth section (lines 115-127).\n- If the Authorize page uses a different alt text, update the selector to match.\n\nMost likely the Ma Earth section is dead code since the scaffold app is not Ma Earth. **Delete lines 115-127 entirely.**\n\n### 2. Fix stale comments\n- Line 93: `Replace Hypercerts logo with horizontal Hypercerts wordmark` → `Replace default PDS logo with Hypercerts horizontal wordmark`\n- Line 130: `Replace \"Sign in with Hypercerts\" with certified-signin SVG image` → `Replace \"Sign in with Hypercerts\" heading with Certified sign-in SVG image`\n- Line 184: `Add Scaffold logo above the H1 using ::before` → `Add Hypercerts wordmark above the Authenticate H1 using ::before`\n- Line 219: `Replace \"Sign in with Hypercerts\" button text on Authenticate page` → `Replace \"Sign in with Hypercerts\" button text with Certified branding on Authenticate page`\n- Line 74: `Hypercerts Scaffold Custom Branding` → `Certified Custom Branding for PDS OAuth Pages`\n\n## Don't\n- Change any CSS selectors, properties, or values (other than removing the Ma Earth block)\n- Change SVG URLs or CSS variables\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. No references to 'Ma Earth' remain in the file\n2. Comments accurately describe what the CSS does (reference 'Certified' branding, not generic 'Scaffold')\n3. No functional CSS behavior changes\n4. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":3,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-17T20:08:32.524067658+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T20:10:09.061239754+06:00","closed_at":"2026-02-17T20:10:09.061239754+06:00","close_reason":"66e4025 Remove Ma Earth leftovers and fix stale comments in branding CSS","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-nyk.17","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T20:08:32.525896579+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.18","title":"Slim down PDS branding CSS: consolidate duplicates, remove redundant sections, prune media queries","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## Context\nCSS review found the branding CSS has ~328 lines of CSS but could be ~190 with zero visual change. This task consolidates duplicates, removes sections that are redundant with the PDS's own styling, and prunes unnecessary media queries.\n\n## What to do\n\n### 1. Consolidate duplicate button replacement blocks (~28 lines saved)\nThe Authenticate page button (lines ~207-232) and submit button (lines ~236-261) are character-for-character identical except for the selector. Merge them by comma-separating selectors:\n\n```css\n/* Button text/icon replacement — both sign-in page submit and Authenticate page button */\nbutton[type=\"submit\"].bg-primary,\nmain.flex.flex-col.items-center \u003e button:nth-of-type(2) {\n  font-size: 0 !important;\n  line-height: 0 !important;\n  display: flex !important;\n  align-items: center !important;\n  justify-content: center !important;\n  gap: 8px !important;\n}\n\nbutton[type=\"submit\"].bg-primary::before,\nmain.flex.flex-col.items-center \u003e button:nth-of-type(2)::before {\n  content: \"\" !important;\n  display: inline-block !important;\n  width: 20px !important;\n  height: 22px !important;\n  background-image: url('${sanitizedLogoUrl}') !important;\n  background-size: contain !important;\n  background-repeat: no-repeat !important;\n  background-position: center !important;\n  flex-shrink: 0 !important;\n}\n\nbutton[type=\"submit\"].bg-primary::after,\nmain.flex.flex-col.items-center \u003e button:nth-of-type(2)::after {\n  content: \"Sign in with Certified\" !important;\n  font-size: 1rem !important;\n  line-height: 1.5rem !important;\n}\n```\n\n### 2. Remove error page section entirely (~20 lines saved)\nDelete lines ~263-282 (the entire `ERROR/SESSION EXPIRY PAGE` section). The `:root` CSS variables already set `--branding-color-error` which the PDS uses to style error pages. The font-size and font-weight overrides are redundant with PDS defaults.\n\nThe `::before { display: none }` rule (which hides the logo on error pages) is only needed because the Authenticate page `::before` selector (`main.flex.flex-col.items-center \u003e h1.text-primary::before`) is broad enough to match error pages too. To fix this properly, make the Authenticate page `::before` selector more specific by excluding error pages:\n\n```css\nmain.flex.flex-col.items-center:not(:has([role=\"alert\"])) \u003e h1.text-primary::before {\n  /* ... existing ::before logo rules ... */\n}\n```\n\nThis way the logo only appears on the Authenticate page, not on error pages, and we don't need the separate error page `display: none` rule.\n\n### 3. Remove mobile fixes section (~33 lines saved)\nDelete lines ~284-317 (the entire `MOBILE SPECIFIC FIXES` section). This contains:\n- `.grid.grow.content-center` justify-items/gap — cosmetic spacing\n- Logo margin-bottom — cosmetic\n- H1 margin adjustments — cosmetic\n- Language selector repositioning — over-engineering (PDS already positions it)\n- Header container `position: relative` — only needed for the language selector hack above\n\nKeep ONLY the `.grid.grow.content-center { justify-items: start }` rule but move it into the desktop alignment section (it's needed for left-alignment consistency).\n\n### 4. Prune H1 media queries (~20 lines saved)\nThe H1 SVG image has 3 breakpoints (default 280x98, 768px 334x117, 1024px 400x140). The SVG scales naturally with `background-size: contain` and `max-width: 100%`. Keep only one desktop override:\n\nDelete the `@media (min-width: 1024px)` block entirely (lines ~160-165).\n\nSimplify the `@media (min-width: 768px)` block — keep the H1 `::after` size override but remove the H1 `margin-top` override (cosmetic).\n\nAlso delete the mobile `@media (max-width: 767px)` block for H1 spacing (lines ~140-145) — cosmetic margin/padding.\n\n### 5. Drop Authenticate page font-size overrides (~12 lines saved)\nDelete lines ~192-203 — the `main.flex.flex-col.items-center \u003e h1.text-primary` font-size/line-height rules and their desktop media query. The PDS already styles its H1 elements. Keep only the `::before` logo insertion.\n\n### 6. Simplify dark mode mobile block (~14 lines saved)\nDelete the `@media (prefers-color-scheme: dark) and (max-width: 767px)` block entirely (lines ~388-402). The dark navy background, padding, and border-radius on mobile are cosmetic polish. The dark mode text overrides for the mobile heading area are also unnecessary if we remove the mobile dark background — the PDS handles dark mode text natively.\n\n### 7. Drop error/warning/success from :root (~6 lines saved)\nThe PDS has sensible defaults for error, warning, and success colors. Only the primary color variables are needed for branding. Delete lines ~83-89 (the error, warning, success variable groups).\n\n## Don't\n- Change any visual behavior that's currently working (logo replacement, H1 image, button text, dark mode panel)\n- Remove the `:root` primary color variables\n- Remove the dark mode block (the main one at lines ~332-386)\n- Remove the desktop alignment section\n- Change SVG asset URLs\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. Button replacement CSS appears only ONCE (consolidated selectors), not duplicated\n2. No error page section exists — the Authenticate `::before` selector excludes error pages via `:not(:has([role=\"alert\"]))`\n3. No mobile fixes section (language selector repositioning, header container positioning removed)\n4. At most ONE desktop media query for H1 sizing (no 1024px breakpoint, no mobile spacing query)\n5. No Authenticate page font-size overrides\n6. No dark mode + mobile combined media query block\n7. Only primary color variables in `:root` (no error/warning/success)\n8. Total CSS inside the template literal is under 200 lines\n9. All existing visual behavior preserved: logo replacement, H1 image (light/dark), button text/icon, dark mode panel, desktop left-alignment\n10. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"kzoeps","owner":"karma.gainforest.id","estimated_minutes":45,"created_at":"2026-02-17T20:49:43.082641677+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T21:03:39.944790522+06:00","closed_at":"2026-02-17T21:03:39.944790522+06:00","close_reason":"7533c19 slim down PDS branding CSS: consolidate duplicates, remove redundant sections","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.18","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T20:49:43.084620156+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.2","title":"Create generateBrandingCss function with neutral scaffold theme","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## What to do\nAdd the `generateBrandingCss(baseUrl: string): string` function to `lib/atproto-branding.ts`. This is the main function that generates ~700 lines of CSS injected into PDS OAuth pages.\n\n**Reference:** Copy the structure from `maearth-app/src/lib/atproto-branding.ts` `generateBrandingCss()` (lines 47-730).\n\n**Function signature:** `export function generateBrandingCss(baseUrl: string): string`\n\n**Parameter:** `baseUrl` — the app base URL (e.g. `https://hypercerts-scaffold.vercel.app`). Used to construct image URLs for logo and branding assets.\n\n**Image URLs to construct (using sanitizeUrlForCss):**\n- Logo: `${baseUrl}/favicon.ico` (placeholder — will be replaced with proper logo later)\n\n**Color mapping — replace Ma Earth colors with scaffold neutral theme:**\n\n| Ma Earth (source) | Scaffold (target) | Usage |\n|---|---|---|\n| #21201F | #2b2d31 | Primary dark (buttons, headings) |\n| #FAF8F6 | #f8f8fa | Primary contrast (button text) |\n| #F2ECE4 | #fafafa | Page background |\n| #1A1715 | #1a1b1e | Dark text |\n| #D4B08A | #4e5058 | Focus rings, accent |\n| #8E6F54 | #757780 | Links, secondary accent |\n| #EAE1D7 | #f0f0f3 | Secondary background |\n| #DDD4C8 | #eaeaed | Hover states |\n| #D4C9BC | #e4e4e8 | Borders |\n| #4C4139 | #4a4b53 | Secondary text |\n| #6B6259 | #5c5d66 | Muted text |\n| #8C8279 | #9a9ba3 | Placeholder text |\n| #B25032 | #e5484d | Error color |\n| #3D6B3D | #2b8a3e | Success color |\n| #D4A84B | #f59f00 | Warning color |\n\n**CSS sections to include (same structure as maearth-app):**\n1. Force light color scheme (`:root` with `--branding-color-*` variables)\n2. Logo replacement (replace Hypercerts logo via background-image trick)\n3. H1 text replacement — use `content: \"Sign in with Certified\"` for now (image replacement will be a follow-up task when SVG assets are provided)\n4. Authenticate page styling\n5. Error/session expiry page styling\n6. Background colors\n7. Text colors\n8. Form inputs\n9. Buttons (primary, secondary, text-only)\n10. Links\n11. Responsive breakpoints (mobile ≤767px, tablet ≥768px, desktop ≥1024px)\n\n**Key difference from maearth-app:** The function takes `baseUrl` instead of `logoUrl`. Construct the logo URL internally as `${baseUrl}/favicon.ico`.\n\n**Text replacements (keep same as maearth-app for now):**\n- H1: \"Sign in with Certified\"\n- Submit button: \"Sign in with Certified\"\n- Authenticate page button: \"Sign in with Certified\"\n\n## Dont\n- Do not modify any other files\n- Do not change the metadata endpoint yet (separate task)\n- Do not use Ma Earth brown/beige colors — use the neutral blue-gray palette above\n- Do not remove or modify the sanitizeUrlForCss function from the previous task","acceptance_criteria":"1. generateBrandingCss is exported from lib/atproto-branding.ts\n2. Function takes baseUrl string parameter and returns a CSS string\n3. All Ma Earth hex colors are replaced with scaffold neutral equivalents per the mapping table\n4. CSS includes all 10 sections listed (color scheme, logo, H1, authenticate page, error page, backgrounds, text, inputs, buttons, responsive)\n5. Logo URL uses ${baseUrl}/favicon.ico\n6. Text replacements say \"Sign in with Certified\"\n7. All image URLs in CSS are sanitized via sanitizeUrlForCss\n8. TypeScript compiles without errors\n9. Returned CSS string is valid CSS (no syntax errors, all braces matched)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":45,"created_at":"2026-02-16T12:30:12.357526519+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-16T12:40:41.909439729+06:00","closed_at":"2026-02-16T12:40:41.909439729+06:00","close_reason":"4b1e809 Add generateBrandingCss function with neutral scaffold theme","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.2","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-16T12:30:12.358740596+06:00","created_by":"karma.gainforest.id"},{"issue_id":"hypercerts-nyk.2","depends_on_id":"hypercerts-nyk.1","type":"blocks","created_at":"2026-02-16T12:30:12.361567421+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.3","title":"Add buildClientMetadata function to lib/config.ts","description":"## Files\n- lib/config.ts (modify)\n\n## What to do\nAdd a `buildClientMetadata()` function to `lib/config.ts` that returns the full OAuth client metadata object. This function replaces the inline object currently in `app/client-metadata.json/route.ts`.\n\n**Why:** The metadata endpoint currently builds its response inline. We need a reusable function that conditionally includes branding CSS in production mode.\n\n**Function signature:** `export function buildClientMetadata(): Record\u003cstring, unknown\u003e`\n\n**Behavior:**\n1. If `config.isLoopback` is true (local dev), return metadata WITHOUT branding:\n   ```\n   {\n     client_id: config.clientId,\n     client_name: \"Hypercerts Scaffold\",\n     client_uri: config.baseUrl,\n     redirect_uris: [config.redirectUri],\n     scope: OAUTH_SCOPE,\n     logo_uri: `${config.baseUrl}/favicon.ico`,\n     grant_types: [\"authorization_code\", \"refresh_token\"],\n     response_types: [\"code\"],\n     token_endpoint_auth_method: \"none\",\n     application_type: \"native\",\n     dpop_bound_access_tokens: true,\n   }\n   ```\n\n2. If NOT loopback (production/preview), return metadata WITH branding:\n   ```\n   {\n     client_id: config.clientId,\n     client_name: \"Hypercerts Scaffold\",\n     client_uri: config.baseUrl,\n     redirect_uris: [config.redirectUri],\n     scope: OAUTH_SCOPE,\n     logo_uri: `${config.baseUrl}/favicon.ico`,\n     grant_types: [\"authorization_code\", \"refresh_token\"],\n     response_types: [\"code\"],\n     token_endpoint_auth_method: \"none\",\n     application_type: \"web\",\n     dpop_bound_access_tokens: true,\n     branding: {\n       css: generateBrandingCss(config.baseUrl),\n     },\n   }\n   ```\n\n**Important:** Keep `token_endpoint_auth_method: \"none\"` in BOTH modes. Upgrading to `private_key_jwt` is a separate concern and out of scope for this task.\n\n**Import:** Add `import { generateBrandingCss } from \"./atproto-branding\";` at the top of the file.\n\n**Placement:** Add the function after the `config` export (around line 204), before the env var validation block.\n\n## Dont\n- Do not change token_endpoint_auth_method (keep \"none\" in both modes)\n- Do not modify the config object itself\n- Do not modify the metadata route file (separate task)\n- Do not change any existing functions (isLoopback, getBaseUrl, etc.)\n- Do not remove any existing exports","acceptance_criteria":"1. buildClientMetadata is exported from lib/config.ts\n2. Function returns object with all required OAuth metadata fields\n3. In loopback mode: no branding field, application_type is \"native\"\n4. In non-loopback mode: branding.css field is present with CSS string from generateBrandingCss, application_type is \"web\"\n5. token_endpoint_auth_method is \"none\" in both modes\n6. Import of generateBrandingCss is added\n7. Existing config export and all other functions are unchanged\n8. TypeScript compiles without errors","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-16T12:30:29.822673508+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-16T12:44:53.362497107+06:00","closed_at":"2026-02-16T12:44:53.362497107+06:00","close_reason":"8fda308 Add buildClientMetadata function with conditional branding","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.3","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-16T12:30:29.824424827+06:00","created_by":"karma.gainforest.id"},{"issue_id":"hypercerts-nyk.3","depends_on_id":"hypercerts-nyk.2","type":"blocks","created_at":"2026-02-16T12:30:29.826498062+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.4","title":"Update client-metadata.json route to use buildClientMetadata","description":"## Files\n- app/client-metadata.json/route.ts (modify)\n\n## What to do\nReplace the inline metadata object in the route handler with a call to `buildClientMetadata()`.\n\n**Current code (replace entirely):**\n```typescript\nimport { config, OAUTH_SCOPE } from \"@/lib/config\";\nimport { NextResponse } from \"next/server\";\n\nexport async function GET() {\n  return NextResponse.json({\n    client_id: config.clientId,\n    client_name: \"Hypercert Scaffold\",\n    client_uri: config.baseUrl,\n    redirect_uris: [config.redirectUri],\n    scope: OAUTH_SCOPE,\n    logo_uri:`${config.baseUrl}/favicon.ico`,\n    grant_types: [\"authorization_code\", \"refresh_token\"],\n    response_types: [\"code\"],\n    token_endpoint_auth_method: \"none\",\n    application_type: config.isLoopback ? \"native\" : \"web\",\n    dpop_bound_access_tokens: true,\n  });\n}\n```\n\n**New code:**\n```typescript\nimport { buildClientMetadata } from \"@/lib/config\";\nimport { NextResponse } from \"next/server\";\n\n/**\n * OAuth Client Metadata Endpoint\n *\n * Returns OAuth client metadata according to RFC 7591.\n * In production mode, includes custom branding CSS for PDS OAuth pages.\n * In loopback mode, returns minimal metadata (PDS ignores it anyway).\n *\n * @see https://datatracker.ietf.org/doc/html/rfc7591\n */\nexport async function GET() {\n  return NextResponse.json(buildClientMetadata());\n}\n```\n\n## Dont\n- Do not add any logic to this file — all logic lives in buildClientMetadata\n- Do not import config or OAUTH_SCOPE directly (buildClientMetadata handles it)\n- Do not add error handling (the metadata is static/deterministic)","acceptance_criteria":"1. Route file imports buildClientMetadata from @/lib/config\n2. Route file does NOT import config or OAUTH_SCOPE directly\n3. GET handler returns NextResponse.json(buildClientMetadata())\n4. No inline metadata object remains\n5. JSDoc comment explains production vs loopback behavior\n6. TypeScript compiles without errors\n7. Visiting /client-metadata.json returns valid JSON with all required OAuth fields","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":10,"created_at":"2026-02-16T12:30:43.916980721+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-16T14:24:30.247312679+06:00","closed_at":"2026-02-16T14:24:30.247312679+06:00","close_reason":"56cd67e refactor: update client-metadata.json route to use buildClientMetadata","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-nyk.4","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-16T12:30:43.918836947+06:00","created_by":"karma.gainforest.id"},{"issue_id":"hypercerts-nyk.4","depends_on_id":"hypercerts-nyk.3","type":"blocks","created_at":"2026-02-16T12:30:43.921011202+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.5","title":"Document ngrok setup for local branding testing","description":"## Files\n- DEVELOPMENT.md (modify)\n\n## What to do\nAdd a section to DEVELOPMENT.md documenting how to test OAuth branding locally using ngrok.\n\n**Context:** ATProto OAuth loopback mode (localhost) cannot support branding CSS — the PDS auto-generates minimal metadata and ignores custom fields. To test branding locally, developers need a public HTTPS URL via a tunnel service.\n\n**Section to add (under a new heading \"Testing OAuth Branding Locally\"):**\n\n1. Explain WHY branding does not appear in local dev (ATProto spec limitation — loopback client_id only supports scope and redirect_uri params, PDS auto-generates metadata)\n2. Explain the ngrok workaround:\n   - Install ngrok: `npm install -g ngrok` or download from ngrok.com\n   - Start tunnel: `ngrok http 3000`\n   - Copy the HTTPS URL (e.g. `https://abc123.ngrok-free.app`)\n   - Set `NEXT_PUBLIC_BASE_URL=https://abc123.ngrok-free.app` in `.env.local`\n   - Restart dev server\n   - The app now enters production mode and serves full metadata with branding at `/client-metadata.json`\n3. Note that `next.config.ts` may need `allowedDevOrigins` configured for ngrok domains (reference existing task hypercerts-scaffold-r25 if it exists)\n4. Note that branding is automatically active on Vercel preview/production deployments — no ngrok needed there\n\n**Placement:** Add after the existing OAuth/authentication section in DEVELOPMENT.md. If no such section exists, add near the end before any appendix/reference sections.\n\n## Dont\n- Do not modify any code files\n- Do not add ngrok as a dependency\n- Do not add NGROK_DOMAIN to .env.example (optional, not required)","acceptance_criteria":"1. DEVELOPMENT.md contains a new section about testing OAuth branding locally\n2. Section explains the ATProto loopback limitation (why branding does not appear locally)\n3. Section includes step-by-step ngrok instructions\n4. Section mentions Vercel preview deployments work automatically\n5. No code files are modified","status":"closed","priority":3,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-16T12:31:00.683521639+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-16T12:35:15.086210654+06:00","closed_at":"2026-02-16T12:35:15.086210654+06:00","close_reason":"76835d7 Document ngrok setup for OAuth branding testing","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-nyk.5","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-16T12:31:00.685341788+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.6","title":"Update DEVELOPMENT.md to clarify PDS trusted client requirement for branding","description":"## Files\n- DEVELOPMENT.md (modify)\n\n## What to do\nUpdate the \"Testing OAuth Branding Locally\" section (around line 341) to clarify that branding CSS is only applied by the PDS for trusted client URLs.\n\n**Key corrections:**\n\n1. **Add a note at the top of the section** explaining that the PDS (`pds-eu-west4.test.certified.app`) only applies branding CSS for client URLs registered in its `PDS_OAUTH_TRUSTED_CLIENTS` environment variable. Random ngrok URLs or unregistered Vercel preview URLs will NOT show branding even though the metadata is served correctly.\n\n2. **Update the ngrok instructions** to clarify that:\n   - Ngrok is still useful for testing that the metadata endpoint serves branding CSS correctly (you can verify by visiting `/client-metadata.json` and checking the `branding` field)\n   - However, the PDS will NOT render the branding on its OAuth pages unless the ngrok URL is added to `PDS_OAUTH_TRUSTED_CLIENTS`\n   - For a stable ngrok domain (paid plan), you can request it be added to the trusted list\n\n3. **Add a subsection \"Getting your domain trusted by the PDS\"** explaining:\n   - To get a domain added to the PDS trusted clients list, contact @aspiers on GitHub\n   - Provide the full client_id URL (e.g. `https://your-app.vercel.app/client-metadata.json`)\n   - Production/stable URLs are preferred over ephemeral ngrok URLs\n\n4. **Update the Vercel section** to note that Vercel preview/production URLs also need to be in the trusted list for branding to appear on the PDS OAuth pages.\n\n5. **Keep the existing content about the ATProto loopback limitation** — that is still correct and separate from the trusted client issue.\n\n## Dont\n- Do not modify any code files\n- Do not remove the existing loopback limitation explanation (it is still correct)\n- Do not change the ngrok setup steps themselves (they are still valid for metadata testing)\n- Do not add any PDS configuration details beyond what is described above","acceptance_criteria":"1. DEVELOPMENT.md explains that PDS only applies branding for URLs in PDS_OAUTH_TRUSTED_CLIENTS\n2. Ngrok section clarifies branding will not render on PDS unless URL is trusted\n3. New subsection explains how to get a domain trusted (contact @aspiers on GitHub)\n4. Vercel section notes that preview/production URLs also need to be trusted\n5. Existing loopback limitation explanation is preserved unchanged\n6. No code files modified","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-16T15:41:38.035046062+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-16T15:43:00.583249811+06:00","closed_at":"2026-02-16T15:43:00.583249811+06:00","close_reason":"1ab09c9 clarify PDS trusted client requirement for OAuth branding","labels":["scope:trivial"],"dependencies":[{"issue_id":"hypercerts-nyk.6","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-16T15:41:38.036527347+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.7","title":"Replace favicon.ico logo references with certified-logo.svg in PDS branding CSS and client metadata","description":"## Files\n- lib/atproto-branding.ts (modify)\n- lib/config.ts (modify)\n\n## What to do\nThe PDS branding CSS currently uses `favicon.ico` as a placeholder logo. Now that the real Certified logo SVG is available at `/public/certified-logo.svg`, update all logo references:\n\n1. In `generateBrandingCss()` (lib/atproto-branding.ts):\n   - Line 57: Change `const logoUrl = \\`\\${baseUrl}/favicon.ico\\`` to `const logoUrl = \\`\\${baseUrl}/certified-logo.svg\\``\n   - This automatically propagates to all CSS `background-image: url(...)` references that use `sanitizedLogoUrl` (lines 89, 186)\n\n2. In `buildClientMetadata()` (lib/config.ts):\n   - Line 226: Change `logo_uri: \\`\\${config.baseUrl}/favicon.ico\\`` to `logo_uri: \\`\\${config.baseUrl}/certified-logo.svg\\``\n   - Line 246: Same change for the production metadata block\n\nThe SVG is 39x43px with a blue checkmark + white partial circle. The existing CSS sizes (180x54 desktop, 120x40 mobile for the main logo; 100x32 for authorize page) should work with `background-size: contain` but may need aspect ratio adjustments since the SVG is roughly square (39:43) while the CSS containers are wide rectangles. Adjust the container dimensions to be more square-ish (e.g., 54x54 desktop, 40x40 mobile, 32x32 authorize page) to avoid distortion.\n\n## Don't\n- Change any CSS selectors or color values\n- Modify sanitizeUrlForCss logic\n- Touch any files other than the two listed","acceptance_criteria":"1. `generateBrandingCss('https://example.com')` output contains `certified-logo.svg` in all url() values and does NOT contain `favicon.ico`\n2. `buildClientMetadata()` returns `logo_uri` ending in `/certified-logo.svg` in both loopback and production modes\n3. Logo container dimensions are adjusted for the roughly-square SVG aspect ratio (no stretched/distorted logo)\n4. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T16:40:54.592940434+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:52:43.176298095+06:00","closed_at":"2026-02-17T16:52:43.176298095+06:00","close_reason":"3e4b912 Replace favicon.ico with certified-logo.svg in branding CSS and client metadata","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.7","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T16:40:54.594543123+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.8","title":"Replace text-based 'Sign in with Certified' with certified-signin.svg image in PDS branding CSS","description":"## Files\n- lib/atproto-branding.ts (modify)\n\n## What to do\nThe PDS branding CSS currently replaces the H1 text and submit button text with plain CSS `content: \"Sign in with Certified\"`. Now that the SVG assets are available, update the text replacements as follows:\n\n### H1 heading → replace with certified-signin.svg image\nThe `certified-signin.svg` (334x117px) is a stylistic image containing the words 'Sign in with Certified' in a designed layout with green background section and checkmark. Use it as an image replacement for the H1 heading only.\n\nThere are 2 H1-related places to update:\n\n**1. Sign-in page H1 (line ~134)**\n```css\n.grid h1.text-primary::after {\n  content: \"Sign in with Certified\" !important;  /* CHANGE THIS */\n}\n```\nChange to use the SVG as a background image:\n```css\n.grid h1.text-primary::after {\n  content: \"\" !important;\n  display: block !important;\n  width: 280px !important;\n  height: 98px !important;\n  max-width: 100% !important;\n  background-image: url('${sanitizedSigninUrl}') !important;\n  background-size: contain !important;\n  background-repeat: no-repeat !important;\n  background-position: right center !important;\n  margin-top: 8px !important;\n}\n```\n\n**2. Desktop H1 variant (line ~157)**\nUpdate the `@media (min-width: 768px)` and `@media (min-width: 1024px)` versions with larger dimensions, keeping the 334:117 (~2.85:1) aspect ratio.\n\n### Submit button → certified-logo.svg icon + text\nThe submit button should show the C logo icon (`certified-logo.svg`, 39x43px) alongside the text \"Sign in with Certified\". This is NOT an image replacement — it's an icon + text combo.\n\nThere are 2 button-related places to update:\n\n**3. Submit button (line ~597-606)**\n```css\nbutton[type=\"submit\"].bg-primary {\n  font-size: 0 !important;\n  line-height: 0 !important;\n}\nbutton[type=\"submit\"].bg-primary::after {\n  content: \"Sign in with Certified\" !important;  /* CHANGE THIS */\n}\n```\nChange to show the C logo as a ::before pseudo-element and keep the text in ::after:\n```css\nbutton[type=\"submit\"].bg-primary {\n  font-size: 0 !important;\n  line-height: 0 !important;\n  display: flex !important;\n  align-items: center !important;\n  justify-content: center !important;\n  gap: 8px !important;\n}\nbutton[type=\"submit\"].bg-primary::before {\n  content: \"\" !important;\n  display: inline-block !important;\n  width: 20px !important;\n  height: 22px !important;\n  background-image: url('${sanitizedLogoUrl}') !important;\n  background-size: contain !important;\n  background-repeat: no-repeat !important;\n  background-position: center !important;\n  flex-shrink: 0 !important;\n}\nbutton[type=\"submit\"].bg-primary::after {\n  content: \"Sign in with Certified\" !important;\n  font-size: 1rem !important;\n  line-height: 1.5rem !important;\n}\n```\n\n**4. Authenticate page button (line ~217-226)**\nSame approach — ::before with C logo icon, ::after with text.\n\n### Implementation\nAdd a new `signinUrl` variable alongside the existing `logoUrl`:\n```typescript\nconst signinUrl = \\`\\${baseUrl}/certified-signin.svg\\`;\nconst sanitizedSigninUrl = sanitizeUrlForCss(signinUrl);\n```\nThe `sanitizedLogoUrl` (for certified-logo.svg) is already available from task .7 — if .7 hasn't run yet, use `\\${baseUrl}/certified-logo.svg` directly and sanitize it.\n\n## Don't\n- Change any color values or non-text-replacement CSS\n- Use certified-signin.svg for the buttons (that's only for the H1)\n- Use certified-logo.svg for the H1 (that's only for the buttons)\n- Remove the H1 text-hiding CSS (`font-size: 0`, `color: transparent`) — still needed to hide original text\n- Touch any files other than lib/atproto-branding.ts","acceptance_criteria":"1. `generateBrandingCss('https://example.com')` output contains `certified-signin.svg` in url() values for H1 ::after pseudo-elements only\n2. `generateBrandingCss('https://example.com')` output contains `certified-logo.svg` in url() values for button ::before pseudo-elements\n3. Submit buttons still show text \"Sign in with Certified\" via ::after (NOT replaced with image)\n4. H1 heading does NOT show text — only the certified-signin.svg image via ::after background-image\n5. The H1 SVG dimensions maintain the 334:117 aspect ratio at all breakpoints\n6. The H1 text-hiding CSS (`font-size: 0`, `color: transparent`) is preserved\n7. TypeScript compiles without errors (`npx tsc --noEmit`)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":45,"created_at":"2026-02-17T16:41:15.429364709+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:54:02.047505676+06:00","closed_at":"2026-02-17T16:54:02.047505676+06:00","close_reason":"52ce32a feat: replace H1 text with certified-signin.svg image, add C logo to buttons","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.8","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T16:41:15.431100348+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-nyk.9","title":"Add Certified C logo next to sign-in buttons in scaffold UI","description":"## Files\n- components/login-dialog.tsx (modify)\n- components/navbar.tsx (modify)\n\n## What to do\nAdd the Certified 'C' logo (`/public/certified-logo.svg`) next to the sign-in buttons in the scaffold's own UI. This is the app's internal branding (separate from the PDS OAuth page branding).\n\nThe SVG is at `/certified-logo.svg` (39x43px, blue checkmark + white partial circle on transparent background). Since the scaffold UI has a light background, the white paths in the SVG won't be visible. The blue checkmark (#60A1E2) will be visible.\n\n### 1. Login Dialog (`components/login-dialog.tsx`)\nThe main sign-in form shown when unauthenticated. Add the logo next to the 'Sign In' button (line 70-77):\n\n```tsx\nimport Image from 'next/image';\n\n// Inside the Sign In button (line 70-77):\n\u003cButton type=\"submit\" disabled={loginMutation.isPending} className=\"...\"\u003e\n  {loginMutation.isPending \u0026\u0026 \u003cSpinner /\u003e}\n  \u003cImage src=\"/certified-logo.svg\" alt=\"Certified\" width={20} height={22} className=\"inline-block\" /\u003e\n  Sign In\n\u003c/Button\u003e\n```\n\nAlso add it next to the 'Create an account' button (line 78-86):\n```tsx\n\u003cButton ... variant=\"ghost\" type=\"button\" className=\"...\"\u003e\n  \u003cImage src=\"/certified-logo.svg\" alt=\"Certified\" width={16} height={18} className=\"inline-block\" /\u003e\n  Create an account\n\u003c/Button\u003e\n```\n\n### 2. Navbar (`components/navbar.tsx`)\nThe compact sign-in popover in the navbar. Add the logo next to the 'Sign In' submit button (line 214-221):\n\n```tsx\nimport Image from 'next/image';\n\n// Inside the popover Sign In button:\n\u003cButton type=\"submit\" size=\"sm\" disabled={loginMutation.isPending} className=\"...\"\u003e\n  \u003cImage src=\"/certified-logo.svg\" alt=\"Certified\" width={16} height={18} className=\"inline-block\" /\u003e\n  {loginMutation.isPending ? \"Signing in...\" : \"Sign In\"}\n\u003c/Button\u003e\n```\n\nUse `next/image` for the Image component (already available in the project). Size the logo proportionally — roughly 20x22px for the main button, 16x18px for smaller buttons. The logo should appear to the left of the button text.\n\n## Don't\n- Change button colors, fonts, or other styling\n- Add the logo to the navbar trigger button (the small 'Sign In' button that opens the popover) — only add it inside the popover form and the login dialog\n- Modify any other components\n- Change the SVG file itself","acceptance_criteria":"1. The login dialog 'Sign In' button shows the Certified C logo to the left of the text\n2. The login dialog 'Create an account' button shows the Certified C logo to the left of the text\n3. The navbar popover 'Sign In' button shows the Certified C logo to the left of the text\n4. Logo uses next/image with appropriate width/height props\n5. Logo is visible and not distorted on both light and dark backgrounds\n6. TypeScript compiles without errors (`npx tsc --noEmit`)\n7. `npm run build` succeeds","status":"closed","priority":2,"issue_type":"task","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T16:41:34.035095764+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T16:44:44.187600046+06:00","closed_at":"2026-02-17T16:44:44.187600046+06:00","close_reason":"d49032c cancelled: misunderstood requirement, no scaffold UI changes needed","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-nyk.9","depends_on_id":"hypercerts-nyk","type":"parent-child","created_at":"2026-02-17T16:41:34.037815811+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-or3","title":"Fix: spurious color: #ffffff added to .grid h1.text-primary::after (from hypercerts-nyk.8)","description":"Review of hypercerts-nyk.8 found: commit 52ce32a added 'color: #ffffff !important;' to the .grid h1.text-primary::after pseudo-element. This property is meaningless since content is empty string (the pseudo-element only shows a background-image). It was not in the spec and violates the 'Don't: Change any color values' constraint. Evidence: git show 52ce32a -- lib/atproto-branding.ts shows the ::after block has 'color: #ffffff !important;' added. Low severity since it has no visual effect, but it is dead code that should be removed.","status":"open","priority":4,"issue_type":"bug","owner":"kzoepa@gmail.com","created_at":"2026-02-17T17:01:11.702386167+06:00","created_by":"kzoeps","updated_at":"2026-02-17T17:01:11.702386167+06:00","dependencies":[{"issue_id":"hypercerts-or3","depends_on_id":"hypercerts-nyk.8","type":"discovered-from","created_at":"2026-02-17T17:01:14.578791497+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-p9n","title":"Epic: Document SDK Packaging and Enhance Developer Experience","status":"closed","priority":1,"issue_type":"epic","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:18:09.88485984+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:28:40.447887994+06:00","closed_at":"2026-02-13T11:28:40.447887994+06:00","close_reason":"Completed all 7 documentation tasks: created DEVELOPMENT.md, added SDK warnings, enhanced loopback docs, improved prerequisites, updated .env.example, reorganized footer, and reviewed code examples"}
{"id":"hypercerts-p9n.1","title":"Create DEVELOPMENT.md with SDK version warnings and development guide","description":"Create a comprehensive DEVELOPMENT.md file covering: (1) Critical warning about unreleased SDK version (0.10.0-beta.8 from vendor/), (2) Explanation of packed packages and why we use them for dogfooding, (3) Warning that installing latest SDK may break scaffold, (4) Step-by-step instructions to update vendor SDK package manually, (5) Local development workflow and setup, (6) Contributing guidelines encouraging users to file issues for @kzoeps. This file serves as the technical reference for developers working with the scaffold.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:18:18.009152902+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:23:15.860547626+06:00","closed_at":"2026-02-13T11:23:15.860547626+06:00","close_reason":"Completed: 5ec8a6e - Created comprehensive DEVELOPMENT.md covering SDK version warnings, packed package explanation, update instructions, development workflow, troubleshooting, and contributing guidelines","dependencies":[{"issue_id":"hypercerts-p9n.1","depends_on_id":"hypercerts-p9n","type":"parent-child","created_at":"2026-02-13T11:18:18.010805084+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-p9n.2","title":"Add SDK version warning section to README.md","description":"Add a prominent '⚠️ Important: SDK Version \u0026 Breaking Changes' section to README.md immediately after the Quick Start section (around line 32). This section must explain: (1) Uses unreleased v0.10.0-beta.8 from vendor/, (2) Built from github.com/hypercerts-org/hypercerts-sdk not npm, (3) Purpose is dogfooding latest features, (4) Contains unreleased/unmerged changes, (5) Breaking changes expected, (6) Installing latest SDK may break scaffold, (7) Link to DEVELOPMENT.md for details, (8) Link to issues at github.com/hypercerts-org/hypercerts-scaffold-atproto with @kzoeps as maintainer. Depends on hypercerts-p9n.1 because DEVELOPMENT.md must exist to link to it.","status":"closed","priority":1,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:18:25.62233731+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:23:59.686592067+06:00","closed_at":"2026-02-13T11:23:59.686592067+06:00","close_reason":"Completed: 1e8c516 - Added SDK version warning section to README after Quick Start with all required details","dependencies":[{"issue_id":"hypercerts-p9n.2","depends_on_id":"hypercerts-p9n","type":"parent-child","created_at":"2026-02-13T11:18:25.623979997+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-p9n.2","depends_on_id":"hypercerts-p9n.1","type":"blocks","created_at":"2026-02-13T11:19:05.137659881+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-p9n.3","title":"Enhance README loopback configuration documentation","description":"Improve the existing loopback configuration docs in README.md: (1) Make Quick Start note more prominent (line 31) - emphasize OAuth requirement for 127.0.0.1, (2) Add TL;DR to 'Localhost Redirect' section (line 127) explaining that .env.local MUST use 127.0.0.1 for OAuth to work, (3) Add troubleshooting subsection with common OAuth issues (callback failed, invalid redirect_uri, redirect loops, ngrok issues). The loopback docs are already comprehensive, this task just enhances clarity and adds troubleshooting.","status":"closed","priority":2,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:18:33.299950647+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:24:57.350432049+06:00","closed_at":"2026-02-13T11:24:57.350432049+06:00","close_reason":"Completed: 2a3277f - Enhanced loopback docs with prominent OAuth requirement, TL;DR, and troubleshooting section","dependencies":[{"issue_id":"hypercerts-p9n.3","depends_on_id":"hypercerts-p9n","type":"parent-child","created_at":"2026-02-13T11:18:33.30151496+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-p9n.4","title":"Improve README prerequisites and installation section","description":"Update Prerequisites section (lines 5-10) in README.md to be more detailed and helpful: (1) Specify Node.js 20+ with nvm recommendation, (2) Mention pnpm explicitly with install command, (3) Expand Redis section with both local Docker and cloud options, (4) Clarify PDS account requirement, (5) Add note referencing DEVELOPMENT.md for SDK details. Update Quick Start section to mention pnpm explicitly and add Redis check before running dev server. Depends on hypercerts-p9n.1 because needs DEVELOPMENT.md to reference it.","status":"closed","priority":2,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:18:41.139193052+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:25:37.166639803+06:00","closed_at":"2026-02-13T11:25:37.166639803+06:00","close_reason":"Completed: e31646b - Updated prerequisites with detailed requirements and Quick Start with pnpm/Redis clarity","dependencies":[{"issue_id":"hypercerts-p9n.4","depends_on_id":"hypercerts-p9n","type":"parent-child","created_at":"2026-02-13T11:18:41.141044172+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-p9n.4","depends_on_id":"hypercerts-p9n.1","type":"blocks","created_at":"2026-02-13T11:19:05.725129883+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-p9n.5","title":"Update .env.example with SDK version reference","description":"Add a header comment block at the top of .env.example file explaining: (1) This scaffold uses unreleased packed SDK version, (2) Reference DEVELOPMENT.md for SDK details and breaking changes, (3) Reference README.md for setup instructions. This provides context for developers when they first copy the file. Depends on hypercerts-p9n.1 because needs DEVELOPMENT.md to reference it.","status":"closed","priority":2,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:18:47.282193967+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:26:10.199986381+06:00","closed_at":"2026-02-13T11:26:10.199986381+06:00","close_reason":"Completed: 4818387 - Added header comment with SDK version warning and references to DEVELOPMENT.md","dependencies":[{"issue_id":"hypercerts-p9n.5","depends_on_id":"hypercerts-p9n","type":"parent-child","created_at":"2026-02-13T11:18:47.283647269+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-p9n.5","depends_on_id":"hypercerts-p9n.1","type":"blocks","created_at":"2026-02-13T11:19:06.370792289+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-p9n.6","title":"Add DEVELOPMENT.md link to README footer","description":"Update the 'Learn More' section (around line 242) in README.md to add DEVELOPMENT.md as the first link under a new 'Scaffold Documentation' subsection. Also add links to report issues (github.com/hypercerts-org/hypercerts-scaffold-atproto/issues) and mention @kzoeps as maintainer. Reorganize external docs links into a separate subsection. Depends on hypercerts-p9n.1 because DEVELOPMENT.md must exist to link to it.","status":"closed","priority":3,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:18:53.526270655+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:26:50.075541431+06:00","closed_at":"2026-02-13T11:26:50.075541431+06:00","close_reason":"Completed: 9aee7d0 - Reorganized Learn More section with DEVELOPMENT.md, external docs, and issue reporting links","dependencies":[{"issue_id":"hypercerts-p9n.6","depends_on_id":"hypercerts-p9n","type":"parent-child","created_at":"2026-02-13T11:18:53.528019597+06:00","created_by":"kzoeps"},{"issue_id":"hypercerts-p9n.6","depends_on_id":"hypercerts-p9n.1","type":"blocks","created_at":"2026-02-13T11:19:06.902665893+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-p9n.7","title":"Review and update code examples in README","description":"Review all code snippets throughout README.md for accuracy with current codebase: (1) Check Authentication section code example (lines 170-187), (2) Check Repository Context section (lines 193-210), (3) Verify all imports are correct, (4) Verify function signatures match current SDK version, (5) Add helpful comments where appropriate, (6) Ensure examples follow best practices. This is a review/polish task to ensure documentation matches implementation.","status":"closed","priority":3,"issue_type":"task","assignee":"kzoeps","owner":"kzoepa@gmail.com","created_at":"2026-02-13T11:19:00.53603122+06:00","created_by":"kzoeps","updated_at":"2026-02-13T11:28:18.636827322+06:00","closed_at":"2026-02-13T11:28:18.636827322+06:00","close_reason":"Completed: 91d11f0 - Reviewed and improved all code examples, added simpler alternatives, fixed authentication flow description","dependencies":[{"issue_id":"hypercerts-p9n.7","depends_on_id":"hypercerts-p9n","type":"parent-child","created_at":"2026-02-13T11:19:00.537513614+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-scaffold-0go","title":"Simplify JWK key generation with script","status":"in_progress","priority":2,"issue_type":"feature","owner":"adam@hypercerts.org","created_at":"2026-01-28T17:13:26.340137246+13:00","created_by":"Adam Spiers","updated_at":"2026-01-28T17:13:32.702507218+13:00"}
{"id":"hypercerts-scaffold-9rb","title":"Migrate OAuth scopes from transitional to granular permissions","description":"Code is using transitional OAuth scopes (transition:generic). Should migrate to granular permissions like repo:* or use ScopePresets.FULL_ACCESS from @hypercerts-org/sdk-core.","notes":"Superseded by new epic with proper decomposition","status":"closed","priority":3,"issue_type":"task","assignee":"karma.gainforest.id","owner":"adam@hypercerts.org","created_at":"2026-01-29T00:00:26.475561542+13:00","created_by":"Adam Spiers","updated_at":"2026-02-17T19:10:10.058147023+06:00","closed_at":"2026-02-17T19:10:10.058154027+06:00"}
{"id":"hypercerts-scaffold-cw2","title":"Add lock mechanism for ATProto credentials","description":"ATProto SDK warning: No lock mechanism provided. Credentials might get revoked. Need to implement a lock mechanism to prevent credential revocation.","status":"open","priority":3,"issue_type":"task","owner":"adam@hypercerts.org","created_at":"2026-01-29T00:00:28.611778943+13:00","created_by":"Adam Spiers","updated_at":"2026-01-29T00:00:28.611778943+13:00"}
{"id":"hypercerts-scaffold-mk1","title":"Fix private JWK format - replace 'use' with 'key_ops'","description":"CRITICAL: Private JWK with 'use' property is causing authentication to fail completely. Error chain: ERR_CRYPTO_INVALID_JWK → ERR_JWK_INVALID → Unable to create JWT. Users cannot log in. Need to replace 'use' with valid 'key_ops' in the JWK configuration.","status":"closed","priority":0,"issue_type":"task","owner":"adam@hypercerts.org","created_at":"2026-01-29T00:00:27.640799834+13:00","created_by":"Adam Spiers","updated_at":"2026-01-29T00:05:01.57288757+13:00","closed_at":"2026-01-29T00:05:01.57288757+13:00","close_reason":"Fixed by regenerating JWK with npm run generate-jwk. The script already correctly sets key_ops and removes the deprecated use property."}
{"id":"hypercerts-scaffold-r25","title":"Configure allowedDevOrigins in next.config for ngrok","description":"Next.js detected cross-origin request from ngrok domain to /_next/* resources. Future versions will require explicit configuration of allowedDevOrigins. See: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins","status":"open","priority":2,"issue_type":"task","owner":"adam@hypercerts.org","created_at":"2026-01-29T00:00:24.942442259+13:00","created_by":"Adam Spiers","updated_at":"2026-01-29T00:00:24.942442259+13:00"}
{"id":"hypercerts-ua9","title":"Fix: redundant `width: 32px` on `div.w-8` container and dead `object-position` on Ma Earth logo in atproto-branding.ts (from hypercerts-nyk.15)","description":"Review of hypercerts-nyk.15 found two redundant CSS rules in lib/atproto-branding.ts.\n\n**Issue 1: Redundant width override (lines 139-143)**\n```css\n.flex.items-center.justify-start.gap-2 \u003e div.w-8:has(img[alt=\"Ma Earth\"]),\ndiv.w-8:has(img[alt=\"Ma Earth\"]) {\n  width: 32px !important;  /* w-8 in Tailwind = 8 × 4px = 32px — same value! */\n  flex-shrink: 0 !important;\n}\n```\nThe selector targets `div.w-8` (Tailwind class meaning width: 2rem = 32px) and then overrides it with `width: 32px` — the exact same value. The `!important` makes no difference here. Only `flex-shrink: 0` is doing real work.\n\n**Issue 2: Ineffective object-position (line 135)**\n```css\nimg[alt=\"Ma Earth\"] {\n  width: 32px !important;\n  height: 32px !important;\n  object-fit: contain !important;\n  object-position: left center !important;  /* no effect */\n}\n```\nThe element is a 32×32px square with `object-fit: contain`. For a square container with a square (or near-square) logo, `object-position` only matters if the image's intrinsic aspect ratio differs from 1:1. Even then, the container is already constrained to 32×32 by the parent `div.w-8`. The `object-position` is effectively a no-op.\n\nEvidence: lib/atproto-branding.ts lines 131-143.\n\nFix:\n1. Remove `width: 32px !important` from the container rule (keep `flex-shrink: 0`)\n2. Remove `object-position: left center !important` from the img rule (or document why it's needed if the logo is non-square)","status":"open","priority":4,"issue_type":"bug","owner":"karma.gainforest.id","created_at":"2026-02-17T19:46:59.09081134+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T19:46:59.09081134+06:00","dependencies":[{"issue_id":"hypercerts-ua9","depends_on_id":"hypercerts-nyk.15","type":"discovered-from","created_at":"2026-02-17T19:47:03.489472674+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-uzx","title":"Fix: inconsistent indentation in buildClientMetadata() production block (from hypercerts-nyk.7)","description":"Review of hypercerts-nyk.7 found: In lib/config.ts, the production return block of buildClientMetadata() has inconsistent indentation. The properties logo_uri, grant_types, response_types, token_endpoint_auth_method, and application_type use 6-space indentation instead of 4-space like the surrounding properties (client_id, client_name, client_uri, redirect_uris, scope, dpop_bound_access_tokens, branding). This was introduced in commit 3e4b912 when the logo_uri line was changed and the surrounding lines were accidentally re-indented. Fix: normalize all properties in the production return block to 4-space indentation. File: lib/config.ts, function buildClientMetadata(), production return block (~lines 235-250).","status":"open","priority":3,"issue_type":"bug","assignee":"karma.gainforest.id","owner":"kzoepa@gmail.com","created_at":"2026-02-17T17:01:13.410081576+06:00","created_by":"kzoeps","updated_at":"2026-02-17T17:01:13.410081576+06:00","dependencies":[{"issue_id":"hypercerts-uzx","depends_on_id":"hypercerts-nyk.7","type":"discovered-from","created_at":"2026-02-17T17:01:16.58517044+06:00","created_by":"kzoeps"}]}
{"id":"hypercerts-v67","title":"Epic: Add Prettier, Husky, and lint-staged for pre-commit checks","description":"The project has ESLint configured (flat config, eslint-config-next) but no Prettier installed (the existing .prettierrc.json has a typo and prettier isn't even a dependency), no husky, and no lint-staged. Goal: install prettier with a proper config, install husky + lint-staged, and wire them together so that on every commit: (1) staged .ts/.tsx/.mjs files are auto-formatted with prettier --write, (2) staged .ts/.tsx files are linted with eslint --fix. The existing .prettierrc.json needs to be fixed (single → singleQuote). Success: git commit triggers pre-commit hook that formats and lints staged files. Scope: prettier config, .prettierignore, husky setup, lint-staged config, package.json scripts. Out of scope: changing ESLint rules, adding new ESLint plugins, reformatting the entire codebase in this epic.","status":"closed","priority":2,"issue_type":"epic","owner":"karma.gainforest.id","created_at":"2026-02-17T18:27:43.973345937+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:54:21.275368642+06:00","closed_at":"2026-02-17T18:54:21.275368642+06:00","close_reason":"ec7549c Prettier, Husky, lint-staged installed and codebase formatted","labels":["scope:small"]}
{"id":"hypercerts-v67.1","title":"Install and configure Prettier, Husky, and lint-staged","description":"## Files\n- package.json (modify — add devDependencies, scripts, lint-staged config)\n- .prettierrc.json (modify — fix typo, add full config)\n- .prettierignore (create)\n- .husky/pre-commit (create via husky init)\n- eslint.config.mjs (modify — add eslint-config-prettier to disable formatting rules that conflict with prettier)\n\n## What to do\n\n### 1. Install dependencies\n\n```bash\nnpm install --save-dev prettier husky lint-staged eslint-config-prettier\n```\n\n### 2. Fix and expand .prettierrc.json\n\nReplace the current broken config with:\n```json\n{\n  \"semi\": true,\n  \"singleQuote\": false,\n  \"tabWidth\": 2,\n  \"trailingComma\": \"all\",\n  \"printWidth\": 80,\n  \"plugins\": [],\n  \"endOfLine\": \"lf\"\n}\n```\n\nNote: `singleQuote: false` preserves the existing codebase convention (double quotes are used everywhere). The old config had `\"single\": false` which is not a valid Prettier key.\n\n### 3. Create .prettierignore\n\n```\nnode_modules/\n.next/\nout/\nbuild/\ncoverage/\n*.tgz\npnpm-lock.yaml\npackage-lock.json\n.beads/\nvendor/\n```\n\n### 4. Add eslint-config-prettier to ESLint config\n\nIn `eslint.config.mjs`, import and add `eslint-config-prettier` to disable ESLint rules that conflict with Prettier. The config should look like:\n\n```js\nimport { defineConfig, globalIgnores } from \"eslint/config\";\nimport nextVitals from \"eslint-config-next/core-web-vitals\";\nimport nextTs from \"eslint-config-next/typescript\";\nimport prettierConfig from \"eslint-config-prettier\";\n\nconst eslintConfig = defineConfig([\n  ...nextVitals,\n  ...nextTs,\n  prettierConfig,\n  globalIgnores([\n    \".next/**\",\n    \"out/**\",\n    \"build/**\",\n    \"next-env.d.ts\",\n  ]),\n]);\n\nexport default eslintConfig;\n```\n\n### 5. Initialize Husky\n\n```bash\nnpx husky init\n```\n\nThis creates `.husky/pre-commit`. Replace its contents with:\n\n```bash\nnpx lint-staged\n```\n\n### 6. Add lint-staged config to package.json\n\nAdd this to package.json at the top level:\n\n```json\n\"lint-staged\": {\n  \"*.{ts,tsx,mjs}\": [\n    \"prettier --write\"\n  ],\n  \"*.{ts,tsx}\": [\n    \"eslint --fix\"\n  ]\n}\n```\n\n### 7. Add scripts to package.json\n\nAdd these scripts (keep existing ones):\n\n```json\n\"format\": \"prettier --write .\",\n\"format:check\": \"prettier --check .\",\n\"prepare\": \"husky\"\n```\n\nThe `prepare` script ensures husky hooks are installed after `npm install`.\n\n### 8. Verify\n\n- Run `npx prettier --check .` — it will likely show files that need formatting (that is OK, we are not reformatting in this task)\n- Run `npm run lint` — should pass\n- Run `npx tsc --noEmit` — should pass\n- Test the hook: stage a file, commit, verify lint-staged runs\n\n## Don't\n- Do NOT reformat the entire codebase (that is a separate task)\n- Do NOT change any ESLint rules (only add eslint-config-prettier to disable conflicting formatting rules)\n- Do NOT add prettier plugins (like prettier-plugin-tailwindcss) — keep it simple\n- Do NOT modify any source files (.ts, .tsx) in this task","acceptance_criteria":"1. prettier is in devDependencies and npx prettier --version works\n2. husky is in devDependencies and .husky/pre-commit exists with \"npx lint-staged\"\n3. lint-staged is in devDependencies and configured in package.json\n4. eslint-config-prettier is in devDependencies and added to eslint.config.mjs\n5. .prettierrc.json has valid config (no \"single\" typo — uses \"singleQuote\")\n6. .prettierignore exists and ignores node_modules, .next, build artifacts\n7. package.json has \"format\", \"format:check\", and \"prepare\" scripts\n8. npm run lint passes (no ESLint errors)\n9. npx tsc --noEmit passes\n10. The pre-commit hook fires on git commit (test with a dummy commit)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":30,"created_at":"2026-02-17T18:28:10.155234891+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:51:18.798142903+06:00","closed_at":"2026-02-17T18:51:18.798142903+06:00","close_reason":"d1d8dc4 feat: install and configure Prettier, Husky, and lint-staged","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-v67.1","depends_on_id":"hypercerts-v67","type":"parent-child","created_at":"2026-02-17T18:28:10.157058697+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-v67.2","title":"Format entire codebase with Prettier","description":"## Files\n- All .ts, .tsx, .mjs, .json, .css files in the project (modify)\n\n## What to do\n\nRun `npm run format` (which runs `prettier --write .`) to format the entire codebase with the Prettier config established in hypercerts-v67.1.\n\nThis should be a single commit with ONLY formatting changes — no logic changes.\n\n### Steps\n\n1. Run `npm run format`\n2. Review the diff to confirm it is ONLY whitespace/formatting changes (quotes, semicolons, trailing commas, line width wrapping, etc.)\n3. Run `npm run lint` to verify ESLint still passes after formatting\n4. Run `npx tsc --noEmit` to verify TypeScript still compiles\n5. Commit with message \"style: format codebase with prettier\"\n\n## Don't\n- Do NOT change any logic, imports, or behavior\n- Do NOT modify .prettierrc.json or any config files\n- Do NOT fix ESLint warnings/errors — only formatting","acceptance_criteria":"1. npm run format:check passes (all files are formatted)\n2. npm run lint passes\n3. npx tsc --noEmit passes\n4. The commit contains ONLY formatting changes (no logic changes)\n5. The app still builds: npm run build passes (or next build)","status":"closed","priority":2,"issue_type":"task","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","estimated_minutes":15,"created_at":"2026-02-17T18:28:24.894020822+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:53:37.62642619+06:00","closed_at":"2026-02-17T18:53:37.62642619+06:00","close_reason":"ec7549c style: format codebase with prettier","labels":["scope:small"],"dependencies":[{"issue_id":"hypercerts-v67.2","depends_on_id":"hypercerts-v67","type":"parent-child","created_at":"2026-02-17T18:28:24.895496835+06:00","created_by":"karma.gainforest.id"},{"issue_id":"hypercerts-v67.2","depends_on_id":"hypercerts-v67.1","type":"blocks","created_at":"2026-02-17T18:28:24.897686609+06:00","created_by":"karma.gainforest.id"}]}
{"id":"hypercerts-zpo","title":"Fix: add-attachment API catch block exposes error in 'details' field not 'error' field — toast shows generic message (from hypercerts-0h4.2)","description":"Review of hypercerts-0h4.2 found: app/api/certs/add-attachment/route.ts was listed in the spec as a file to modify but was NOT changed by the 0h4.2 commit. The catch block currently returns { error: 'Internal server error', details: (e as Error).message } (line 122). The apiClient in lib/api/client.ts only reads the 'error' field from the JSON response (line 56), so the 'details' field with the actual error message is silently dropped. The mutation hook onError toast will show 'Internal server error' instead of the actual error reason. Fix: change the catch block to return { error: `Failed to add attachment: ${(e as Error).message}` } — drop the 'details' field and put the message in 'error'. Evidence: git show 4a0ef47 --name-only (add-attachment not listed); cat app/api/certs/add-attachment/route.ts line 122; lib/api/client.ts line 56.","status":"closed","priority":2,"issue_type":"bug","assignee":"karma.gainforest.id","owner":"karma.gainforest.id","created_at":"2026-02-17T18:26:26.571299814+06:00","created_by":"karma.gainforest.id","updated_at":"2026-02-17T18:30:43.057850292+06:00","closed_at":"2026-02-17T18:30:43.057850292+06:00","close_reason":"96729ad fix: put actual error message in 'error' field in add-attachment catch block","dependencies":[{"issue_id":"hypercerts-zpo","depends_on_id":"hypercerts-0h4.2","type":"discovered-from","created_at":"2026-02-17T18:26:30.543462831+06:00","created_by":"karma.gainforest.id"}]}
